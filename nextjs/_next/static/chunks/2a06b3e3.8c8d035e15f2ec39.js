(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[995],{8297:function(){!function(){var t,e=window.jQuery,n="mathquill-command-id",i="mathquill-block-id",s=Math.min,r=Math.max;if(!e)throw"MathQuill requires jQuery 1.5.2+ to be loaded first";function noop(){}var o=[].slice;function variadic(t){var e=t.length-1;return function(){var n=o.call(arguments,0,e),i=o.call(arguments,e);return t.apply(this,n.concat([i]))}}var a=variadic(function(t,e){return variadic(function(n,i){if(t in n)return n[t].apply(n,e.concat(i))})});function iterator(t){return variadic(function(e,n){return"function"!=typeof e&&(e=a(e)),t.call(this,function(t){return e.apply(t,[t].concat(n))})})}function bind(t){var e=o.call(arguments,1);return function(){return t.apply(this,e)}}function pray(t,e){if(!e)throw Error("prayer failed: "+t)}var l=function(t,e,n){function isObject(t){return"object"==typeof t}function isFunction(t){return"function"==typeof t}function SuperclassBare(){}return function P(n,i){function C(){var t=new Bare;return isFunction(t.init)&&t.init.apply(t,arguments),t}function Bare(){}void 0===i&&(i=n,n=Object),C.Bare=Bare;var s,r=SuperclassBare[t]=n[t],o=Bare[t]=C[t]=C.p=new SuperclassBare;return o.constructor=C,C.extend=function(t){return P(C,t)},(C.open=function(t){if(s={},isFunction(t)?s=t.call(C,o,r,C,n):isObject(t)&&(s=t),isObject(s))for(var i in s)e.call(s,i)&&(o[i]=s[i]);return isFunction(o.init)||(o.init=n),C})(i)}}("prototype",{}.hasOwnProperty);function prayDirection(t){pray("a direction was passed",-1===t||1===t)}var c=l(e,function(t){t.insDirOf=function(t,e){return -1===t?this.insertBefore(e.first()):this.insertAfter(e.last())},t.insAtDirEnd=function(t,e){return -1===t?this.prependTo(e):this.appendTo(e)}}),h=l(function(t){t.parent=0,t[-1]=0,t[1]=0,t.init=function(t,e,n){this.parent=t,this[-1]=e,this[1]=n},this.copy=function(t){return h(t.parent,t[-1],t[1])}}),u=l(function(t){t[-1]=0,t[1]=0,t.parent=0;var e=0;this.byId={},t.init=function(){this.id=e+=1,u.byId[this.id]=this,this.ends={},this.ends[-1]=0,this.ends[1]=0},t.dispose=function(){delete u.byId[this.id]},t.toString=function(){return"{{ MathQuill Node #"+this.id+" }}"},t.jQ=c(),t.jQadd=function(t){return this.jQ=this.jQ.add(t)},t.jQize=function(t){for(var t=c(t||this.html()),e=0;e<t.length;e+=1)!function jQadd(t){if(t.getAttribute){var e=t.getAttribute("mathquill-command-id"),n=t.getAttribute("mathquill-block-id");e&&u.byId[e].jQadd(t),n&&u.byId[n].jQadd(t)}for(t=t.firstChild;t;t=t.nextSibling)jQadd(t)}(t[e]);return t},t.createDir=function(t,e){return prayDirection(t),this.jQize(),this.jQ.insDirOf(t,e.jQ),e[t]=this.adopt(e.parent,e[-1],e[1]),this},t.createLeftOf=function(t){return this.createDir(-1,t)},t.selectChildren=function(t,e){return b(t,e)},t.bubble=iterator(function(t){for(var e=this;e&&!1!==t(e);e=e.parent);return this}),t.postOrder=iterator(function(t){return function recurse(e){e.eachChild(recurse),t(e)}(this),this}),t.isEmpty=function(){return 0===this.ends[-1]&&0===this.ends[1]},t.isStyleBlock=function(){return!1},t.children=function(){return d(this.ends[-1],this.ends[1])},t.eachChild=function(){var t=this.children();return t.each.apply(t,arguments),this},t.foldChildren=function(t,e){return this.children().fold(t,e)},t.withDirAdopt=function(t,e,n,i){return d(this,this).withDirAdopt(t,e,n,i),this},t.adopt=function(t,e,n){return d(this,this).adopt(t,e,n),this},t.disown=function(){return d(this,this).disown(),this},t.remove=function(){return this.jQ.remove(),this.postOrder("dispose"),this.disown()}});function prayWellFormed(t,e,n){pray("a parent is always present",t),pray("leftward is properly set up",e?e[1]===n&&e.parent===t:t.ends[-1]===n),pray("rightward is properly set up",n?n[-1]===e&&n.parent===t:t.ends[1]===e)}var d=l(function(e){e.init=function(e,n,i){if(t===i&&(i=-1),prayDirection(i),pray("no half-empty fragments",!e==!n),this.ends={},e){pray("withDir is passed to Fragment",e instanceof u),pray("oppDir is passed to Fragment",n instanceof u),pray("withDir and oppDir have the same parent",e.parent===n.parent),this.ends[i]=e,this.ends[-i]=n;var s=this.fold([],function(t,e){return t.push.apply(t,e.jQ.get()),t});this.jQ=this.jQ.add(s)}},e.jQ=c(),e.withDirAdopt=function(t,e,n,i){return -1===t?this.adopt(e,n,i):this.adopt(e,i,n)},e.adopt=function(t,e,n){prayWellFormed(t,e,n),this.disowned=!1;var i=this.ends[-1];if(!i)return this;var s=this.ends[1];return e||(t.ends[-1]=i),n?n[-1]=s:t.ends[1]=s,this.ends[1][1]=n,this.each(function(n){n[-1]=e,n.parent=t,e&&(e[1]=n),e=n}),this},e.disown=function(){var t=this.ends[-1];if(!t||this.disowned)return this;this.disowned=!0;var e=this.ends[1],n=t.parent;return prayWellFormed(n,t[-1],t),prayWellFormed(n,e,e[1]),t[-1]?t[-1][1]=e[1]:n.ends[-1]=e[1],e[1]?e[1][-1]=t[-1]:n.ends[1]=t[-1],this},e.remove=function(){return this.jQ.remove(),this.each("postOrder","dispose"),this.disown()},e.each=iterator(function(t){var e=this.ends[-1];if(!e)return this;for(;e!==this.ends[1][1]&&!1!==t(e);e=e[1]);return this}),e.fold=function(t,e){return this.each(function(n){t=e.call(this,t,n)}),t}}),f={},p={},m=l(h,function(e){e.init=function(t,e){this.parent=t,this.options=e;var n=this.jQ=this._jQ=c('<span class="mq-cursor">&#8203;</span>');this.blink=function(){n.toggleClass("mq-blink")},this.upDownCache={}},e.show=function(){return this.jQ=this._jQ.removeClass("mq-blink"),"intervalId"in this?clearInterval(this.intervalId):(this[1]?this.selection&&this.selection.ends[-1][-1]===this[-1]?this.jQ.insertBefore(this.selection.jQ):this.jQ.insertBefore(this[1].jQ.first()):this.jQ.appendTo(this.parent.jQ),this.parent.focus()),this.intervalId=setInterval(this.blink,500),this},e.hide=function(){return"intervalId"in this&&clearInterval(this.intervalId),delete this.intervalId,this.jQ.detach(),this.jQ=c(),this},e.withDirInsertAt=function(t,e,n,i){var s=this.parent;this.parent=e,this[t]=n,this[-t]=i,s!==e&&s.blur&&s.blur(this)},e.insDirOf=function(t,e){return prayDirection(t),this.jQ.insDirOf(t,e.jQ),this.withDirInsertAt(t,e.parent,e[t],e),this.parent.jQ.addClass("mq-hasCursor"),this},e.insLeftOf=function(t){return this.insDirOf(-1,t)},e.insRightOf=function(t){return this.insDirOf(1,t)},e.insAtDirEnd=function(t,e){return prayDirection(t),this.jQ.insAtDirEnd(t,e.jQ),this.withDirInsertAt(t,e,0,e.ends[t]),e.focus(),this},e.insAtLeftEnd=function(t){return this.insAtDirEnd(-1,t)},e.insAtRightEnd=function(t){return this.insAtDirEnd(1,t)},e.jumpUpDown=function(t,e){this.upDownCache[t.id]=h.copy(this);var n=this.upDownCache[e.id];if(n)n[1]?this.insLeftOf(n[1]):this.insAtRightEnd(n.parent);else{var i=this.offset().left;e.seek(i,this)}},e.offset=function(){var t=this.jQ.removeClass("mq-cursor").offset();return this.jQ.addClass("mq-cursor"),t},e.unwrapGramp=function(){var t=this.parent.parent,e=t.parent,n=t[1],i=t[-1];if(t.disown().eachChild(function(s){s.isEmpty()||(s.children().adopt(e,i,n).each(function(e){e.jQ.insertBefore(t.jQ.first())}),i=s.ends[1])}),!this[1]){if(this[-1])this[1]=this[-1][1];else for(;!this[1];)if(this.parent=this.parent[1],this.parent)this[1]=this.parent.ends[-1];else{this[1]=t[1],this.parent=e;break}}this[1]?this.insLeftOf(this[1]):this.insAtRightEnd(e),t.jQ.remove(),t[-1].siblingDeleted&&t[-1].siblingDeleted(this.options,1),t[1].siblingDeleted&&t[1].siblingDeleted(this.options,-1)},e.startSelection=function(){for(var t=this.anticursor=h.copy(this),e=t.ancestors={},n=t;n.parent;n=n.parent)e[n.parent.id]=n},e.endSelection=function(){delete this.anticursor},e.select=function(){var t=this.anticursor;if(this[-1]===t[-1]&&this.parent===t.parent)return!1;for(var e=this;e.parent;e=e.parent)if(e.parent.id in t.ancestors){var n=e.parent;break}pray("cursor and anticursor in the same tree",n);var i,s,r=t.ancestors[n.id],o=1;if(e[-1]!==r){for(var a=e;a;a=a[1])if(a[1]===r[1]){o=-1,i=e,s=r;break}}return 1===o&&(i=r,s=e),i instanceof h&&(i=i[1]),s instanceof h&&(s=s[-1]),this.hide().selection=n.selectChildren(i,s),this.insDirOf(o,this.selection.ends[o]),this.selectionChanged(),!0},e.clearSelection=function(){return this.selection&&(this.selection.clear(),delete this.selection,this.selectionChanged()),this},e.deleteSelection=function(){this.selection&&(this[-1]=this.selection.ends[-1][-1],this[1]=this.selection.ends[1][1],this.selection.remove(),this.selectionChanged(),delete this.selection)},e.replaceSelection=function(){var t=this.selection;return t&&(this[-1]=t.ends[-1][-1],this[1]=t.ends[1][1],delete this.selection),t},e.depth=function(){for(var t=this,e=0;t=t.parent;)e+=t instanceof M?1:0;return e},e.isTooDeep=function(e){if(t!==this.options.maxDepth)return this.depth()+(e||0)>this.options.maxDepth}}),b=l(d,function(t,e){t.init=function(){e.init.apply(this,arguments),this.jQ=this.jQ.wrapAll('<span class="mq-selection"></span>').parent()},t.adopt=function(){return this.jQ.replaceWith(this.jQ=this.jQ.children()),e.adopt.apply(this,arguments)},t.clear=function(){return this.jQ.replaceWith(this.jQ[0].childNodes),this},t.join=function(t){return this.fold("",function(e,n){return e+n[t]()})}}),g=l(function(t){t.init=function(t,e,n){this.id=t.id,this.data={},this.root=t,this.container=e,this.options=n,t.controller=this,this.cursor=t.cursor=m(t,n)},t.handle=function(t,e){var n=this.options.handlers;if(n&&n.fns[t]){var i=n.APIClasses[this.KIND_OF_MQ](this);-1===e||1===e?n.fns[t](e,i):n.fns[t](i)}};var e=[];this.onNotify=function(t){e.push(t)},t.notify=function(){for(var t=0;t<e.length;t+=1)e[t].apply(this.cursor,arguments);return this}}),v={},w=l(),x={},q=l(),y={};function insistOnInterVer(){window.console&&console.warn('You are using the MathQuill API without specifying an interface version, which will fail in v1.0.0. Easiest fix is to do the following before doing anything else:\n\n    MathQuill = MathQuill.getInterface(1);\n    // now MathQuill.MathField() works like it used to\n\nSee also the "`dev` branch (2014–2015) → v0.10.0 Migration Guide" at\n  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide')}function MathQuill(t){return insistOnInterVer(),ty(t)}MathQuill.prototype=q.p,MathQuill.VERSION="v0.11.0",MathQuill.interfaceVersion=function(t){if(1!==t)throw"Only interface version 1 supported. You specified: "+t;return(insistOnInterVer=function(){window.console&&console.warn('You called MathQuill.interfaceVersion(1); to specify the interface version, which will fail in v1.0.0. You can fix this easily by doing this before doing anything else:\n\n    MathQuill = MathQuill.getInterface(1);\n    // now MathQuill.MathField() works like it used to\n\nSee also the "`dev` branch (2014–2015) → v0.10.0 Migration Guide" at\n  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide')})(),MathQuill},MathQuill.getInterface=getInterface;var O=getInterface.MIN=1,k=getInterface.MAX=2;function getInterface(t){if(!(O<=t&&t<=k))throw"Only interface versions between "+O+" and "+k+" supported. You specified: "+t;function MQ(t){if(!t||!t.nodeType)return null;var e=c(t).children(".mq-root-block").attr(i),s=e&&u.byId[e].controller;return s?n[s.KIND_OF_MQ](s):null}var n={};function config(t,e){for(var i in e&&e.handlers&&(e.handlers={fns:e.handlers,APIClasses:n}),e)if(e.hasOwnProperty(i)){var s=e[i],r=x[i];t[i]=r?r(s):s}}MQ.L=-1,MQ.R=1,MQ.saneKeyboardEvents=T,MQ.config=function(t){return config(w.p,t),this},MQ.registerEmbed=function(t,e){if(!/^[a-z][a-z0-9]*$/i.test(t))throw"Embed name must start with letter and be only letters and digits";y[t]=e};var s=n.AbstractMathQuill=l(q,function(t){t.init=function(t){this.__controller=t,this.__options=t.options,this.id=t.id,this.data=t.data},t.__mathquillify=function(t){var e=this.__controller,n=e.root,s=e.container;e.createTextarea();var r=s.addClass(t).contents().detach();n.jQ=c('<span class="mq-root-block"/>').attr(i,n.id).appendTo(s),this.latex(r.text()),this.revert=function(){return s.empty().unbind(".mathquill").removeClass("mq-editable-field mq-math-mode mq-text-mode").append(r)}},t.config=function(t){return config(this.__options,t),this},t.el=function(){return this.__controller.container[0]},t.text=function(){return this.__controller.exportText()},t.latex=function(t){return arguments.length>0?(this.__controller.renderLatexMath(t),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this):this.__controller.exportLatex()},t.html=function(){return this.__controller.root.jQ.html().replace(/ mathquill-(?:command|block)-id="?\d+"?/g,"").replace(/<span class="?mq-cursor( mq-blink)?"?>.?<\/span>/i,"").replace(/ mq-hasCursor|mq-hasCursor ?/,"").replace(/ class=(""|(?= |>))/g,"")},t.reflow=function(){return this.__controller.root.postOrder("reflow"),this}});for(var r in MQ.prototype=s.prototype,n.EditableField=l(s,function(t,n){t.__mathquillify=function(){return n.__mathquillify.apply(this,arguments),this.__controller.editable=!0,this.__controller.delegateMouseEvents(),this.__controller.editablesTextareaEvents(),this},t.focus=function(){return this.__controller.textarea.focus(),this},t.blur=function(){return this.__controller.textarea.blur(),this},t.write=function(t){return this.__controller.writeLatex(t),this.__controller.scrollHoriz(),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this},t.empty=function(){var t=this.__controller.root,e=this.__controller.cursor;return t.eachChild("postOrder","dispose"),t.ends[-1]=t.ends[1]=0,t.jQ.empty(),delete e.selection,e.insAtRightEnd(t),this},t.cmd=function(t){var e=this.__controller.notify(),n=e.cursor;if(/^\\[a-z]+$/i.test(t)&&!n.isTooDeep()){var i=f[t=t.slice(1)];i&&(t=i(t),n.selection&&t.replaces(n.replaceSelection()),t.createLeftOf(n.show()),this.__controller.scrollHoriz())}else n.parent.write(n,t);return e.blurred&&n.hide().parent.blur(),this},t.select=function(){var t=this.__controller;for(t.notify("move").cursor.insAtRightEnd(t.root);t.cursor[-1];)t.selectLeft();return this},t.clearSelection=function(){return this.__controller.cursor.clearSelection(),this},t.moveToDirEnd=function(t){return this.__controller.notify("move").cursor.insAtDirEnd(t,this.__controller.root),this},t.moveToLeftEnd=function(){return this.moveToDirEnd(-1)},t.moveToRightEnd=function(){return this.moveToDirEnd(1)},t.keystroke=function(t){for(var t=t.replace(/^\s+|\s+$/g,"").split(/\s+/),e=0;e<t.length;e+=1)this.__controller.keystroke(t[e],{preventDefault:noop});return this},t.typedText=function(t){for(var e=0;e<t.length;e+=1)this.__controller.typedText(t.charAt(e));return this},t.dropEmbedded=function(t,e,n){var i=t-c(window).scrollLeft(),s=e-c(window).scrollTop(),r=document.elementFromPoint(i,s);this.__controller.seek(c(r),t,e),to().setOptions(n).createLeftOf(this.__controller.cursor)},t.clickAt=function(t,n,i){i=i||document.elementFromPoint(t,n);var s=this.__controller,r=s.root;return e.contains(r.jQ[0],i)||(i=r.jQ[0]),s.seek(c(i),t+pageXOffset,n+pageYOffset),s.blurred&&this.focus(),this},t.ignoreNextMousedown=function(t){return this.__controller.cursor.options.ignoreNextMousedown=t,this}}),MQ.EditableField=function(){throw"wtf don't call me, I'm 'abstract'"},MQ.EditableField.prototype=n.EditableField.prototype,v)!function(e,i){var s=n[e]=i(n);MQ[e]=function(n,i){var r=MQ(n);if(r instanceof s||!n||!n.nodeType)return r;var o=g(s.RootBlock(),c(n),w());return o.KIND_OF_MQ=e,s(o).__mathquillify(i,t)},MQ[e].prototype=s.prototype}(r,v[r]);return MQ}MathQuill.noConflict=function(){return window.MathQuill=Q,MathQuill};var Q=window.MathQuill;function RootBlockMixin(t){for(var e="moveOutOf deleteOutOf selectOutOf upOutOf downOutOf".split(" "),n=0;n<e.length;n+=1)!function(e){t[e]=function(t){this.controller.handle(e,t)}}(e[n]);t.reflow=function(){this.controller.handle("reflow"),this.controller.handle("edited"),this.controller.handle("edit")}}window.MathQuill=MathQuill;var T=(N={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"},function(t,n){var i,s=null,r=null,o=e(t),a=e(n.container||o),l=noop;function checkTextareaFor(t){l=t,clearTimeout(i),i=setTimeout(t)}function checkTextareaOnce(t){checkTextareaFor(function(e){l=noop,clearTimeout(i),t(e)})}a.bind("keydown keypress input keyup focusout paste",function(t){l(t)});var c=!1;function handleKey(){var t,e,i,r,o;n.keystroke((r=N[i=(t=s).which||t.keyCode],o=[],(t.ctrlKey&&o.push("Ctrl"),t.originalEvent&&t.originalEvent.metaKey&&o.push("Meta"),t.altKey&&o.push("Alt"),t.shiftKey&&o.push("Shift"),e=r||String.fromCharCode(i),o.length||r)?(o.push(e),o.join("-")):e),s)}function typedText(){var t;if(!("selectionStart"in(t=o[0])&&t.selectionStart!==t.selectionEnd)){var e=o.val();1===e.length?(o.val(""),n.typedText(e)):e&&o[0].select&&o[0].select()}}function pastedText(){var t=o.val();o.val(""),t&&n.paste(t)}return a.bind({keydown:function(t){s=t,r=null,c&&checkTextareaOnce(function(t){!(t&&"focusout"===t.type)&&o[0].select&&o[0].select()}),handleKey()},keypress:function(t){s&&r&&handleKey(),r=t,checkTextareaFor(typedText)},keyup:function(t){s&&!r&&checkTextareaFor(typedText)},focusout:function(){s=r=null},cut:function(){checkTextareaOnce(function(){n.cut()})},copy:function(){checkTextareaOnce(function(){n.copy()})},paste:function(t){o.focus(),checkTextareaFor(pastedText)}}),{select:function(t){l(),l=noop,clearTimeout(i),o.val(t),t&&o[0].select&&o[0].select(),c=!!t}}}),j=l(function(t,e,n){function parseError(t,e){throw"Parse Error: "+e+" at "+(t=t?"'"+t+"'":"EOF")}t.init=function(t){this._=t},t.parse=function(t){return this.skip(r)._(""+t,function(t,e){return e},parseError)},t.or=function(t){pray("or is passed a parser",t instanceof n);var e=this;return n(function(n,i,s){return e._(n,i,function(e){return t._(n,i,s)})})},t.then=function(t){var e=this;return n(function(i,s,r){return e._(i,function(e,i){var o=t instanceof n?t:t(i);return pray("a parser is returned",o instanceof n),o._(e,s,r)},r)})},t.many=function(){var t=this;return n(function(e,n,i){for(var s=[];t._(e,success,failure););return n(e,s);function success(t,n){return e=t,s.push(n),!0}function failure(){return!1}})},t.times=function(t,e){arguments.length<2&&(e=t);var i=this;return n(function(n,s,r){for(var o,a=[],l=!0,c=0;c<t;c+=1)if(!(l=i._(n,success,firstFailure)))return r(n,o);for(;c<e&&l;c+=1)l=i._(n,success,secondFailure);return s(n,a);function success(t,e){return a.push(e),n=t,!0}function firstFailure(t,e){return o=e,n=t,!1}function secondFailure(t,e){return!1}})},t.result=function(t){return this.then(s(t))},t.atMost=function(t){return this.times(0,t)},t.atLeast=function(t){var e=this;return e.times(t).then(function(t){return e.many().map(function(e){return t.concat(e)})})},t.map=function(t){return this.then(function(e){return s(t(e))})},t.skip=function(t){return this.then(function(e){return t.result(e)})},this.string=function(t){var e=t.length,i="expected '"+t+"'";return n(function(n,s,r){var o=n.slice(0,e);return o===t?s(n.slice(e),o):r(n,i)})};var i=this.regex=function(t){pray("regexp parser is anchored","^"===t.toString().charAt(1));var e="expected "+t;return n(function(n,i,s){var r=t.exec(n);if(!r)return s(n,e);var o=r[0];return i(n.slice(o.length),o)})},s=n.succeed=function(t){return n(function(e,n){return n(e,t)})};n.fail=function(t){return n(function(e,n,i){return i(e,t)})},n.letter=i(/^[a-z]/i),n.letters=i(/^[a-z]*/i),n.digit=i(/^[0-9]/),n.digits=i(/^[0-9]*/),n.whitespace=i(/^\s+/),n.optWhitespace=i(/^\s*/),n.any=n(function(t,e,n){return t?e(t.slice(1),t.charAt(0)):n(t,"expected any character")}),n.all=n(function(t,e,n){return e("",t)});var r=n.eof=n(function(t,e,n){return t?n(t,"expected EOF"):e(t,t)})});g.open(function(t){t.focusBlurEvents=function(){var t,e=this,n=e.root,i=e.cursor;function windowBlur(){clearTimeout(t),i.selection&&i.selection.jQ.addClass("mq-blur"),blur()}function blur(){i.hide().parent.blur(),e.container.removeClass("mq-focused"),c(window).unbind("blur",windowBlur)}e.textarea.focus(function(){e.blurred=!1,clearTimeout(t),e.container.addClass("mq-focused"),i.parent||i.insAtRightEnd(n),i.selection?(i.selection.jQ.removeClass("mq-blur"),e.selectionChanged()):i.show()}).blur(function(){e.blurred=!0,t=setTimeout(function(){n.postOrder("intentionalBlur"),i.clearSelection().endSelection(),blur()}),c(window).bind("blur",windowBlur)}),e.blurred=!0,i.hide().parent.blur()}}),g.open(function(t,e){t.exportText=function(){return this.root.foldChildren("",function(t,e){return t+e.text()})}}),g.open(function(e){w.p.ignoreNextMousedown=noop,e.delegateMouseEvents=function(){var e=this.root.jQ;this.container.bind("mousedown.mathquill",function(n){var s,r=c(n.target).closest(".mq-root-block"),o=u.byId[r.attr(i)||e.attr(i)].controller,a=o.cursor,l=a.blink,h=o.textareaSpan,d=o.textarea;function mousemove(t){s=c(t.target)}function docmousemove(e){a.anticursor||a.startSelection(),o.seek(s,e.pageX,e.pageY).cursor.select(),s=t}n.preventDefault(),n.target.unselectable=!0,a.options.ignoreNextMousedown(n)||(a.options.ignoreNextMousedown=noop,o.blurred&&(o.editable||r.prepend(h),d.focus()),a.blink=noop,o.seek(c(n.target),n.pageX,n.pageY).cursor.startSelection(),r.mousemove(mousemove),c(n.target.ownerDocument).mousemove(docmousemove).mouseup(function mouseup(t){a.blink=l,a.selection||(o.editable?a.show():h.detach()),r.unbind("mousemove",mousemove),c(t.target.ownerDocument).unbind("mousemove",docmousemove).unbind("mouseup",mouseup)}))})}}),g.open(function(t){t.seek=function(t,e,s){var r=this.notify("select").cursor;if(t){var o=t.attr(i)||t.attr(n);if(!o){var a=t.parent();o=a.attr(i)||a.attr(n)}}var l=o?u.byId[o]:this.root;return pray("nodeId is the id of some Node that exists",l),r.clearSelection().show(),l.seek(e,r),this.scrollHoriz(),this}}),g.open(function(t){t.keystroke=function(t,e){this.cursor.parent.keystroke(t,e,this)}}),u.open(function(t){t.keystroke=function(t,e,n){var i=n.cursor;switch(t){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":n.ctrlDeleteDir(-1);break;case"Shift-Backspace":case"Backspace":n.backspace();break;case"Esc":case"Tab":n.escapeDir(1,t,e);return;case"Shift-Tab":case"Shift-Esc":n.escapeDir(-1,t,e);return;case"End":n.notify("move").cursor.insAtRightEnd(i.parent);break;case"Ctrl-End":n.notify("move").cursor.insAtRightEnd(n.root);break;case"Shift-End":for(;i[1];)n.selectRight();break;case"Ctrl-Shift-End":for(;i[1]||i.parent!==n.root;)n.selectRight();break;case"Home":n.notify("move").cursor.insAtLeftEnd(i.parent);break;case"Ctrl-Home":n.notify("move").cursor.insAtLeftEnd(n.root);break;case"Shift-Home":for(;i[-1];)n.selectLeft();break;case"Ctrl-Shift-Home":for(;i[-1]||i.parent!==n.root;)n.selectLeft();break;case"Left":n.moveLeft();break;case"Shift-Left":n.selectLeft();break;case"Ctrl-Left":case"Ctrl-Right":break;case"Right":n.moveRight();break;case"Shift-Right":n.selectRight();break;case"Up":n.moveUp();break;case"Down":n.moveDown();break;case"Shift-Up":if(i[-1])for(;i[-1];)n.selectLeft();else n.selectLeft();case"Shift-Down":if(i[1])for(;i[1];)n.selectRight();else n.selectRight();case"Ctrl-Up":case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":n.ctrlDeleteDir(1);break;case"Shift-Del":case"Del":n.deleteForward();break;case"Meta-A":case"Ctrl-A":for(n.notify("move").cursor.insAtRightEnd(n.root);i[-1];)n.selectLeft();break;default:return}e.preventDefault(),n.scrollHoriz()},t.moveOutOf=t.moveTowards=t.deleteOutOf=t.deleteTowards=t.unselectInto=t.selectOutOf=t.selectTowards=function(){pray("overridden or never called on this node")}}),g.open(function(t){function moveUpDown(t,e){var n=t.notify("upDown").cursor,i=e+"Into",s=e+"OutOf";return n[1][i]?n.insAtLeftEnd(n[1][i]):n[-1][i]?n.insAtRightEnd(n[-1][i]):n.parent.bubble(function(t){var e=t[s];if(e&&("function"==typeof e&&(e=t[s](n)),e instanceof u&&n.jumpUpDown(t,e),!0!==e))return!1}),t}this.onNotify(function(t){("move"===t||"upDown"===t)&&this.show().clearSelection()}),t.escapeDir=function(t,e,n){prayDirection(t);var i=this.cursor;if(i.parent!==this.root&&n.preventDefault(),i.parent!==this.root)return i.parent.moveOutOf(t,i),this.notify("move")},x.leftRightIntoCmdGoes=function(t){if(t&&"up"!==t&&"down"!==t)throw'"up" or "down" required for leftRightIntoCmdGoes option, got "'+t+'"';return t},t.moveDir=function(t){prayDirection(t);var e=this.cursor,n=e.options.leftRightIntoCmdGoes;return e.selection?e.insDirOf(t,e.selection.ends[t]):e[t]?e[t].moveTowards(t,e,n):e.parent.moveOutOf(t,e,n),this.notify("move")},t.moveLeft=function(){return this.moveDir(-1)},t.moveRight=function(){return this.moveDir(1)},t.moveUp=function(){return moveUpDown(this,"up")},t.moveDown=function(){return moveUpDown(this,"down")},this.onNotify(function(t){"upDown"!==t&&(this.upDownCache={})}),this.onNotify(function(t){"edit"===t&&this.show().deleteSelection()}),t.deleteDir=function(t){prayDirection(t);var e=this.cursor,n=e.selection;return this.notify("edit"),n||(e[t]?e[t].deleteTowards(t,e):e.parent.deleteOutOf(t,e)),e[-1].siblingDeleted&&e[-1].siblingDeleted(e.options,1),e[1].siblingDeleted&&e[1].siblingDeleted(e.options,-1),e.parent.bubble("reflow"),this},t.ctrlDeleteDir=function(t){prayDirection(t);var e=this.cursor;return!e[t]||e.selection?this.deleteDir(t):(this.notify("edit"),-1===t?d(e.parent.ends[-1],e[-1]).remove():d(e[1],e.parent.ends[1]).remove(),e.insAtDirEnd(t,e.parent),e[-1].siblingDeleted&&e[-1].siblingDeleted(e.options,1),e[1].siblingDeleted&&e[1].siblingDeleted(e.options,-1),e.parent.bubble("reflow"),this)},t.backspace=function(){return this.deleteDir(-1)},t.deleteForward=function(){return this.deleteDir(1)},this.onNotify(function(t){"select"!==t&&this.endSelection()}),t.selectDir=function(t){var e=this.notify("select").cursor,n=e.selection;prayDirection(t),e.anticursor||e.startSelection();var i=e[t];i?n&&n.ends[t]===i&&e.anticursor[-t]!==i?i.unselectInto(t,e):i.selectTowards(t,e):e.parent.selectOutOf(t,e),e.clearSelection(),e.select()||e.show()},t.selectLeft=function(){return this.selectDir(-1)},t.selectRight=function(){return this.selectDir(1)}}),g.open(function(n){w.p.substituteTextarea=function(){return c("<textarea autocapitalize=off autocomplete=off autocorrect=off spellcheck=false x-palm-disable-ste-all=true />")[0]},n.createTextarea=function(){var t=this.textareaSpan=c('<span class="mq-textarea"></span>'),e=this.options.substituteTextarea();if(!e.nodeType)throw"substituteTextarea() must return a DOM element, got "+e;e=this.textarea=c(e).appendTo(t);var n=this;n.cursor.selectionChanged=function(){n.selectionChanged()}},n.selectionChanged=function(){var e=this;W(e.container[0]),t===e.textareaSelectionTimeout&&(e.textareaSelectionTimeout=setTimeout(function(){e.setTextareaSelection()}))},n.setTextareaSelection=function(){this.textareaSelectionTimeout=t;var e="";this.cursor.selection&&(e=this.cursor.selection.join("latex"),this.options.statelessClipboard&&(e="$"+e+"$")),this.selectFn(e)},n.staticMathTextareaEvents=function(){var t=this,n=(t.root,t.cursor),i=t.textarea,s=t.textareaSpan;function detach(){s.detach(),t.blurred=!0}this.container.prepend(e('<span class="mq-selectable">').text("$"+t.exportLatex()+"$")),t.blurred=!0,i.bind("cut paste",!1).bind("copy",function(){t.setTextareaSelection()}).focus(function(){t.blurred=!1}).blur(function(){n.selection&&n.selection.clear(),setTimeout(detach)}),t.selectFn=function(t){i.val(t),t&&i.select()}},w.p.substituteKeyboardEvents=T,n.editablesTextareaEvents=function(){var t=this.textarea,e=this.textareaSpan,n=this.options.substituteKeyboardEvents(t,this);this.selectFn=function(t){n.select(t)},this.container.prepend(e),this.focusBlurEvents()},n.typedText=function(t){if("\n"===t)return this.handle("enter");var e=this.notify().cursor;e.parent.write(e,t),this.scrollHoriz()},n.cut=function(){var t=this,e=t.cursor;e.selection&&setTimeout(function(){t.notify("edit"),e.parent.bubble("reflow")})},n.copy=function(){this.setTextareaSelection()},n.paste=function(t){this.options.statelessClipboard&&(t="$"===t.slice(0,1)&&"$"===t.slice(-1)?t.slice(1,-1):"\\text{"+t+"}"),this.writeLatex(t).cursor.show()}});var D=function(){function joinBlocks(t){for(var e=t[0]||M(),n=1;n<t.length;n+=1)t[n].children().adopt(e,e.ends[1],0);return e}var t=j.string,e=j.regex,n=j.letter,i=j.any,s=j.optWhitespace,r=j.succeed,o=j.fail,a=n.map(function(t){return tc(t)}),l=e(/^[^${}\\_^]/).map(function(t){return A(t)}),c=e(/^[^\\a-eg-zA-Z]/).or(t("\\").then(e(/^[a-z]+/i).or(e(/^\s+/).result(" ")).or(i))).then(function(t){var e=f[t];return e?e(t).parser():o("unknown command: \\"+t)}).or(a).or(l),h=t("{").then(function(){return d}).skip(t("}")),u=s.then(h.or(c.map(function(t){var e=M();return t.adopt(e,0,0),e}))),d=u.many().map(joinBlocks).skip(s),p=t("[").then(u.then(function(t){return"]"!==t.join("latex")?r(t):o()}).many().map(joinBlocks).skip(s)).skip(t("]"));return d.block=u,d.optBlock=p,d}();g.open(function(e,n){e.exportLatex=function(){return this.root.latex().replace(/(\\[a-z]+) (?![a-z])/ig,"$1")},x.maxDepth=function(e){return"number"==typeof e?e:t},e.writeLatex=function(t){var e=this.notify("edit").cursor,n=j.all,i=j.eof,s=D.skip(i).or(n.result(!1)).parse(t);return s&&!s.isEmpty()&&s.prepareInsertionAt(e)&&(s.children().adopt(e.parent,e[-1],e[1]),s.jQize().insertBefore(e.jQ),e[-1]=s.ends[1],s.finalizeInsert(e.options,e),s.ends[1][1].siblingCreated&&s.ends[1][1].siblingCreated(e.options,-1),s.ends[-1][-1].siblingCreated&&s.ends[-1][-1].siblingCreated(e.options,1),e.parent.bubble("reflow")),this},e.renderLatexMath=function(t){var e=this.root,n=this.cursor;n.options;var i=e.jQ,s=j.all,r=j.eof,o=D.skip(r).or(s.result(!1)).parse(t);if(e.eachChild("postOrder","dispose"),e.ends[-1]=e.ends[1]=0,o&&o.prepareInsertionAt(n)){o.children().adopt(e,0,0);var a=o.join("html");i.html(a),e.jQize(i.children()),e.finalizeInsert(n.options)}else i.empty();delete n.selection,n.insAtRightEnd(e)},e.renderLatexText=function(t){var e=this.root,n=this.cursor;e.jQ.children().slice(1).remove(),e.eachChild("postOrder","dispose"),e.ends[-1]=e.ends[1]=0,delete n.selection,n.show().insAtRightEnd(e);var i=j.regex,s=j.string,r=j.eof,o=j.all,a=s("$").then(D).skip(s("$").or(r)).map(function(t){var e=z(n);e.createBlocks();var i=e.ends[-1];return t.children().adopt(i,0,0),e}),l=s("\\$").result("$").or(i(/^[^$]/)).map(A),c=a.or(l).many().skip(r).or(o.result(!1)).parse(t);if(c){for(var h=0;h<c.length;h+=1)c[h].adopt(e,e.ends[1],0);e.jQize().appendTo(e.jQ),e.finalizeInsert(n.options)}}}),g.open(function(t){t.scrollHoriz=function(){var t=this.cursor,e=t.selection,n=this.root.jQ[0].getBoundingClientRect();if(e){var i=e.jQ[0].getBoundingClientRect(),s=i.left-(n.left+20),r=i.right-(n.right-20);if(e.ends[-1]===t[1]){if(s<0)var o=s;else if(!(r>0))return;else if(i.left-r<n.left+20)var o=s;else var o=r}else if(r>0)var o=r;else if(!(s<0))return;else if(i.right-s>n.right-20)var o=r;else var o=s}else{var a=t.jQ[0].getBoundingClientRect().left;if(a>n.right-20)var o=a-(n.right-20);else if(!(a<n.left+20))return;else var o=a-(n.left+20)}this.root.jQ.stop().animate({scrollLeft:"+="+o},100)}});var _=l(u,function(e,n){e.finalizeInsert=function(t,e){this.postOrder("finalizeTree",t),this.postOrder("contactWeld",e),this.postOrder("blur"),this.postOrder("reflow"),this[1].siblingCreated&&this[1].siblingCreated(t,-1),this[-1].siblingCreated&&this[-1].siblingCreated(t,1),this.bubble("reflow")},e.prepareInsertionAt=function(e){var n=e.options.maxDepth;if(t!==n){var i=e.depth();if(i>n)return!1;this.removeNodesDeeperThan(n-i)}return!0},e.removeNodesDeeperThan=function(t){for(var e,n=0,i=[[this,0]];i.length;)(e=i.shift())[0].children().each(function(s){var r=s instanceof M?1:0;(n=e[1]+r)<=t?i.push([s,n]):(r?s.children():s).remove()})}}),S=l(_,function(t,e){t.init=function(t,n,i){e.init.call(this),this.ctrlSeq||(this.ctrlSeq=t),n&&(this.htmlTemplate=n),i&&(this.textTemplate=i)},t.replaces=function(t){t.disown(),this.replacedFragment=t},t.isEmpty=function(){return this.foldChildren(!0,function(t,e){return t&&e.isEmpty()})},t.parser=function(){var t=D.block,e=this;return t.times(e.numBlocks()).map(function(t){e.blocks=t;for(var n=0;n<t.length;n+=1)t[n].adopt(e,e.ends[1],0);return e})},t.createLeftOf=function(t){var n=this.replacedFragment;this.createBlocks(),e.createLeftOf.call(this,t),n&&(n.adopt(this.ends[-1],0,0),n.jQ.appendTo(this.ends[-1].jQ),this.placeCursor(t),this.prepareInsertionAt(t)),this.finalizeInsert(t.options),this.placeCursor(t)},t.createBlocks=function(){for(var t=this.numBlocks(),e=this.blocks=Array(t),n=0;n<t;n+=1)(e[n]=M()).adopt(this,this.ends[1],0)},t.placeCursor=function(t){t.insAtRightEnd(this.foldChildren(this.ends[-1],function(t,e){return t.isEmpty()?t:e}))},t.moveTowards=function(t,e,n){var i=n&&this[n+"Into"];e.insAtDirEnd(-t,i||this.ends[-t])},t.deleteTowards=function(t,e){this.isEmpty()?e[t]=this.remove()[t]:this.moveTowards(t,e,null)},t.selectTowards=function(t,e){e[-t]=this,e[t]=this[t]},t.selectChildren=function(){return b(this,this)},t.unselectInto=function(t,e){e.insAtDirEnd(-t,e.anticursor.ancestors[this.id])},t.seek=function(t,e){function getBounds(t){var e={};return e[-1]=t.jQ.offset().left,e[1]=e[-1]+t.jQ.outerWidth(),e}var n=this,i=getBounds(n);if(t<i[-1])return e.insLeftOf(n);if(t>i[1])return e.insRightOf(n);var s=i[-1];n.eachChild(function(r){var o=getBounds(r);return t<o[-1]?(t-s<o[-1]-t?r[-1]?e.insAtRightEnd(r[-1]):e.insLeftOf(n):e.insAtLeftEnd(r),!1):t>o[1]?void(r[1]?s=o[1]:i[1]-t<t-o[1]?e.insRightOf(n):e.insAtRightEnd(r)):(r.seek(t,e),!1)})},t.numBlocks=function(){var t=this.htmlTemplate.match(/&\d+/g);return t?t.length:0},t.html=function(){var t=this.blocks,e=" mathquill-command-id="+this.id,n=this.htmlTemplate.match(/<[^<>]+>|[^<>]+/g);pray("no unmatched angle brackets",n.join("")===this.htmlTemplate);for(var i=0,s=n[0];s;i+=1,s=n[i])if("/>"===s.slice(-2))n[i]=s.slice(0,-2)+e+"/>";else if("<"===s.charAt(0)){pray("not an unmatched top-level close tag","/"!==s.charAt(1)),n[i]=s.slice(0,-1)+e+">";var r=1;do i+=1,pray("no missing close tags",s=n[i]),"</"===s.slice(0,2)?r-=1:"<"===s.charAt(0)&&"/>"!==s.slice(-2)&&(r+=1);while(r>0)}return n.join("").replace(/>&(\d+)/g,function(e,n){return" mathquill-block-id="+t[n].id+">"+t[n].join("html")})},t.latex=function(){return this.foldChildren(this.ctrlSeq,function(t,e){return t+"{"+(e.latex()||" ")+"}"})},t.textTemplate=[""],t.text=function(){var t=this,e=0;return t.foldChildren(t.textTemplate[e],function(n,i){e+=1;var s=i.text();return n&&"("===t.textTemplate[e]&&"("===s[0]&&")"===s.slice(-1)?n+s.slice(1,-1)+t.textTemplate[e]:n+s+(t.textTemplate[e]||"")})}}),E=l(S,function(t,e){t.init=function(t,n,i){i||(i=t&&t.length>1?t.slice(1):t),e.init.call(this,t,n,[i])},t.parser=function(){return j.succeed(this)},t.numBlocks=function(){return 0},t.replaces=function(t){t.remove()},t.createBlocks=noop,t.moveTowards=function(t,e){e.jQ.insDirOf(t,this.jQ),e[-t]=this,e[t]=this[t]},t.deleteTowards=function(t,e){e[t]=this.remove()[t]},t.seek=function(t,e){t-this.jQ.offset().left<this.jQ.outerWidth()/2?e.insLeftOf(this):e.insRightOf(this)},t.latex=function(){return this.ctrlSeq},t.text=function(){return this.textTemplate},t.placeCursor=noop,t.isEmpty=function(){return!0}}),A=l(E,function(t,e){t.init=function(t,n){e.init.call(this,t,"<span>"+(n||t)+"</span>")}}),L=l(E,function(t,e){t.init=function(t,n,i){e.init.call(this,t,'<span class="mq-binary-operator">'+n+"</span>",i)}}),M=l(_,function(t,e){t.join=function(t){return this.foldChildren("",function(e,n){return e+n[t]()})},t.html=function(){return this.join("html")},t.latex=function(){return this.join("latex")},t.text=function(){return this.ends[-1]===this.ends[1]&&0!==this.ends[-1]?this.ends[-1].text():this.join("text")},t.keystroke=function(t,n,i){if(i.options.spaceBehavesLikeTab&&("Spacebar"===t||"Shift-Spacebar"===t)){n.preventDefault(),i.escapeDir("Shift-Spacebar"===t?-1:1,t,n);return}return e.keystroke.apply(this,arguments)},t.moveOutOf=function(t,e,n){!(n&&this.parent[n+"Into"])&&this[t]?e.insAtDirEnd(-t,this[t]):e.insDirOf(t,this.parent)},t.selectOutOf=function(t,e){e.insDirOf(t,this.parent)},t.deleteOutOf=function(t,e){e.unwrapGramp()},t.seek=function(t,e){var n=this.ends[1];if(!n||n.jQ.offset().left+n.jQ.outerWidth()<t)return e.insAtRightEnd(this);if(t<this.ends[-1].jQ.offset().left)return e.insAtLeftEnd(this);for(;t<n.jQ.offset().left;)n=n[-1];return n.seek(t,e)},t.chToCmd=function(t,e){var n;return t.match(/^[a-eg-zA-Z]$/)?tc(t):/^\d$/.test(t)?ta(t):e&&e.typingSlashWritesDivisionSymbol&&"/"===t?f["\xf7"](t):e&&e.typingAsteriskWritesTimesSymbol&&"*"===t?f["\xd7"](t):(n=p[t]||f[t])?n(t):A(t)},t.write=function(t,e){var n=this.chToCmd(e,t.options);t.selection&&n.replaces(t.replaceSelection()),t.isTooDeep()||n.createLeftOf(t.show())},t.focus=function(){return this.jQ.addClass("mq-hasCursor"),this.jQ.removeClass("mq-empty"),this},t.blur=function(){return this.jQ.removeClass("mq-hasCursor"),this.isEmpty()&&this.jQ.addClass("mq-empty"),this}});w.p.mouseEvents=!0,v.StaticMath=function(t){return l(t.AbstractMathQuill,function(e,n){this.RootBlock=M,e.__mathquillify=function(t,e){return this.config(t),n.__mathquillify.call(this,"mq-math-mode"),this.__options.mouseEvents&&(this.__controller.delegateMouseEvents(),this.__controller.staticMathTextareaEvents()),this},e.init=function(){n.init.apply(this,arguments),this.__controller.root.postOrder("registerInnerField",this.innerFields=[],t.MathField)},e.latex=function(){var e=n.latex.apply(this,arguments);return arguments.length>0&&this.__controller.root.postOrder("registerInnerField",this.innerFields=[],t.MathField),e}})};var B=l(M,RootBlockMixin);v.MathField=function(t){return l(t.EditableField,function(t,e){this.RootBlock=B,t.__mathquillify=function(t,n){return this.config(t),n>1&&(this.__controller.root.reflow=noop),e.__mathquillify.call(this,"mq-editable-field mq-math-mode"),delete this.__controller.root.reflow,this}})};var I=l(u,function(t,e){function fuseChildren(t){t.jQ[0].normalize();var e=t.jQ[0].firstChild;if(e){pray("only node in TextBlock span is Text node",3===e.nodeType);var n=R(e.data);return n.jQadd(e),t.children().disown(),n.adopt(t,0,0)}}t.ctrlSeq="\\text",t.replaces=function(t){t instanceof d?this.replacedText=t.remove().jQ.text():"string"==typeof t&&(this.replacedText=t)},t.jQadd=function(t){e.jQadd.call(this,t),this.ends[-1]&&this.ends[-1].jQadd(this.jQ[0].firstChild)},t.createLeftOf=function(t){if(e.createLeftOf.call(this,t),this[1].siblingCreated&&this[1].siblingCreated(t.options,-1),this[-1].siblingCreated&&this[-1].siblingCreated(t.options,1),this.bubble("reflow"),t.insAtRightEnd(this),this.replacedText)for(var n=0;n<this.replacedText.length;n+=1)this.write(t,this.replacedText.charAt(n))},t.parser=function(){var t=this,e=j.string,n=j.regex;return j.optWhitespace.then(e("{")).then(n(/^[^}]*/)).skip(e("}")).map(function(e){return 0===e.length?d():(R(e).adopt(t,0,0),t)})},t.textContents=function(){return this.foldChildren("",function(t,e){return t+e.text})},t.text=function(){return'"'+this.textContents()+'"'},t.latex=function(){var t=this.textContents();return 0===t.length?"":"\\text{"+t.replace(/\\/g,"\\backslash ").replace(/[{}]/g,"\\$&")+"}"},t.html=function(){return'<span class="mq-text-mode" mathquill-command-id='+this.id+">"+this.textContents()+"</span>"},t.moveTowards=function(t,e){e.insAtDirEnd(-t,this)},t.moveOutOf=function(t,e){e.insDirOf(t,this)},t.unselectInto=t.moveTowards,t.selectTowards=S.prototype.selectTowards,t.deleteTowards=S.prototype.deleteTowards,t.selectOutOf=function(t,e){e.insDirOf(t,this)},t.deleteOutOf=function(t,e){this.isEmpty()&&e.insRightOf(this)},t.write=function(t,n){if(t.show().deleteSelection(),"$"!==n)t[-1]?t[-1].appendText(n):R(n).createLeftOf(t);else if(this.isEmpty())t.insRightOf(this),A("\\$","$").createLeftOf(t);else if(t[1]){if(t[-1]){var i=I(),s=this.ends[-1];s.disown().jQ.detach(),s.adopt(i,0,0),t.insLeftOf(this),e.createLeftOf.call(i,t)}else t.insLeftOf(this)}else t.insRightOf(this)},t.seek=function(t,e){e.hide();var n=fuseChildren(this),i=this.jQ.width()/this.text.length,s=Math.round((t-this.jQ.offset().left)/i);s<=0?e.insAtLeftEnd(this):s>=n.text.length?e.insAtRightEnd(this):e.insLeftOf(n.splitRight(s));for(var r=t-e.show().offset().left,o=r&&r<0?-1:1,a=o;e[o]&&r*a>0;)e[o].moveTowards(o,e),a=r,r=t-e.offset().left;if(o*r<-o*a&&e[-o].moveTowards(-o,e),e.anticursor){if(e.anticursor.parent===this){var l=e[-1]&&e[-1].text.length;if(this.anticursorPosition===l)e.anticursor=h.copy(e);else{if(this.anticursorPosition<l){var c=e[-1].splitRight(this.anticursorPosition);e[-1]=c}else var c=e[1].splitRight(this.anticursorPosition-l);e.anticursor=h(this,c[-1],c)}}}else this.anticursorPosition=e[-1]&&e[-1].text.length},t.blur=function(t){M.prototype.blur.call(this),t&&(""===this.textContents()?(this.remove(),t[-1]===this?t[-1]=this[-1]:t[1]===this&&(t[1]=this[1])):fuseChildren(this))},t.focus=M.prototype.focus}),R=l(u,function(t,e){function endChar(t,e){return e.charAt(-1===t?0:-1+e.length)}t.init=function(t){e.init.call(this),this.text=t},t.jQadd=function(t){this.dom=t,this.jQ=c(t)},t.jQize=function(){return this.jQadd(document.createTextNode(this.text))},t.appendText=function(t){this.text+=t,this.dom.appendData(t)},t.prependText=function(t){this.text=t+this.text,this.dom.insertData(0,t)},t.insTextAtDirEnd=function(t,e){prayDirection(e),1===e?this.appendText(t):this.prependText(t)},t.splitRight=function(t){var e=R(this.text.slice(t)).adopt(this.parent,this,this[1]);return e.jQadd(this.dom.splitText(t)),this.text=this.text.slice(0,t),e},t.moveTowards=function(t,e){prayDirection(t);var n=endChar(-t,this.text),i=this[-t];return i?i.insTextAtDirEnd(n,t):R(n).createDir(-t,e),this.deleteTowards(t,e)},t.latex=function(){return this.text},t.deleteTowards=function(t,e){this.text.length>1?1===t?(this.dom.deleteData(0,1),this.text=this.text.slice(1)):(this.dom.deleteData(-1+this.text.length,1),this.text=this.text.slice(0,-1)):(this.remove(),this.jQ.remove(),e[t]=this[t])},t.selectTowards=function(t,e){prayDirection(t);var n=e.anticursor,i=endChar(-t,this.text);if(n[t]===this){var s=R(i).createDir(t,e);n[t]=s,e.insDirOf(t,s)}else{var r=this[-t];if(r)r.insTextAtDirEnd(i,t);else{var s=R(i).createDir(-t,e);s.jQ.insDirOf(-t,e.selection.jQ)}1===this.text.length&&n[-t]===this&&(n[-t]=this[-t])}return this.deleteTowards(t,e)}});function makeTextBlock(t,e,n){return l(I,{ctrlSeq:t,htmlTemplate:"<"+e+" "+n+">&0</"+e+">"})}f.text=f.textnormal=f.textrm=f.textup=f.textmd=I,f.em=f.italic=f.italics=f.emph=f.textit=f.textsl=makeTextBlock("\\textit","i",'class="mq-text-mode"'),f.strong=f.bold=f.textbf=makeTextBlock("\\textbf","b",'class="mq-text-mode"'),f.sf=f.textsf=makeTextBlock("\\textsf","span",'class="mq-sans-serif mq-text-mode"'),f.tt=f.texttt=makeTextBlock("\\texttt","span",'class="mq-monospace mq-text-mode"'),f.textsc=makeTextBlock("\\textsc","span",'style="font-variant:small-caps" class="mq-text-mode"'),f.uppercase=makeTextBlock("\\uppercase","span",'style="text-transform:uppercase" class="mq-text-mode"'),f.lowercase=makeTextBlock("\\lowercase","span",'style="text-transform:lowercase" class="mq-text-mode"');var z=l(S,function(t,e){t.init=function(t){e.init.call(this,"$"),this.cursor=t},t.htmlTemplate='<span class="mq-math-mode">&0</span>',t.createBlocks=function(){e.createBlocks.call(this),this.ends[-1].cursor=this.cursor,this.ends[-1].write=function(t,e){"$"!==e?M.prototype.write.call(this,t,e):this.isEmpty()?(t.insRightOf(this.parent),this.parent.deleteTowards(dir,t),A("\\$","$").createLeftOf(t.show())):t[1]?t[-1]?M.prototype.write.call(this,t,e):t.insLeftOf(this.parent):t.insRightOf(this.parent)}},t.latex=function(){return"$"+this.ends[-1].latex()+"$"}}),F=l(B,function(t,e){t.keystroke=function(t){if("Spacebar"!==t&&"Shift-Spacebar"!==t)return e.keystroke.apply(this,arguments)},t.write=function(t,e){if(t.show().deleteSelection(),"$"===e)z(t).createLeftOf(t);else{var n;"<"===e?n="&lt;":">"===e&&(n="&gt;"),A(e,n).createLeftOf(t)}}});v.TextField=function(t){return l(t.EditableField,function(t,e){this.RootBlock=F,t.__mathquillify=function(){return e.__mathquillify.call(this,"mq-editable-field mq-text-mode")},t.latex=function(t){return arguments.length>0?(this.__controller.renderLatexText(t),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this):this.__controller.exportLatex()}})},p["\\"]=l(S,function(t,e){t.ctrlSeq="\\",t.replaces=function(t){this._replacedFragment=t.disown(),this.isEmpty=function(){return!1}},t.htmlTemplate='<span class="mq-latex-command-input mq-non-leaf">\\<span>&0</span></span>',t.textTemplate=["\\"],t.createBlocks=function(){e.createBlocks.call(this),this.ends[-1].focus=function(){return this.parent.jQ.addClass("mq-hasCursor"),this.isEmpty()&&this.parent.jQ.removeClass("mq-empty"),this},this.ends[-1].blur=function(){return this.parent.jQ.removeClass("mq-hasCursor"),this.isEmpty()&&this.parent.jQ.addClass("mq-empty"),this},this.ends[-1].write=function(t,e){t.show().deleteSelection(),e.match(/[a-z]/i)?A(e).createLeftOf(t):(this.parent.renderCommand(t),"\\"===e&&this.isEmpty()||t.parent.write(t,e))},this.ends[-1].keystroke=function(t,n,i){if("Tab"===t||"Enter"===t||"Spacebar"===t){this.parent.renderCommand(i.cursor),n.preventDefault();return}return e.keystroke.apply(this,arguments)}},t.createLeftOf=function(t){if(e.createLeftOf.call(this,t),this._replacedFragment){var n=this.jQ[0];this.jQ=this._replacedFragment.jQ.addClass("mq-blur").bind("mousedown mousemove",function(t){return c(t.target=n).trigger(t),!1}).insertBefore(this.jQ).add(this.jQ)}},t.latex=function(){return"\\"+this.ends[-1].latex()+" "},t.renderCommand=function(t){this.jQ=this.jQ.last(),this.remove(),this[1]?t.insLeftOf(this[1]):t.insAtRightEnd(this.parent);var e=this.ends[-1].latex();e||(e=" ");var n=f[e];n?(n=n(e),this._replacedFragment&&n.replaces(this._replacedFragment),n.createLeftOf(t)):((n=I()).replaces(e),n.createLeftOf(t),t.insRightOf(n),this._replacedFragment&&this._replacedFragment.remove())}});var N,$,U,W=noop,V=document.createElement("div").style,H={transform:1,WebkitTransform:1,MozTransform:1,OTransform:1,msTransform:1};for(var K in H)if(K in V){U=K;break}U?$=function(t,e,n){t.css(U,"scale("+e+","+n+")")}:"filter"in V?(W=function(t){t.className=t.className},$=function(t,e,n){e/=1+(n-1)/2,t.css("fontSize",n+"em"),t.hasClass("mq-matrixed-container")||t.addClass("mq-matrixed-container").wrapInner('<span class="mq-matrixed"></span>');var i=t.children().css("filter","progid:DXImageTransform.Microsoft.Matrix(M11="+e+",SizingMethod='auto expand')");function calculateMarginRight(){t.css("marginRight",(i.width()-1)*(e-1)/e+"px")}calculateMarginRight();var s=setInterval(calculateMarginRight);c(window).load(function(){clearTimeout(s),calculateMarginRight()})}):$=function(t,e,n){t.css("fontSize",n+"em")};var G=l(S,function(t,e){t.init=function(t,n,i){e.init.call(this,t,"<"+n+" "+i+">&0</"+n+">")}});f.mathrm=bind(G,"\\mathrm","span",'class="mq-roman mq-font"'),f.mathit=bind(G,"\\mathit","i",'class="mq-font"'),f.mathbf=bind(G,"\\mathbf","b",'class="mq-font"'),f.mathsf=bind(G,"\\mathsf","span",'class="mq-sans-serif mq-font"'),f.mathtt=bind(G,"\\mathtt","span",'class="mq-monospace mq-font"'),f.underline=bind(G,"\\underline","span",'class="mq-non-leaf mq-underline"'),f.overline=f.bar=bind(G,"\\overline","span",'class="mq-non-leaf mq-overline"'),f.overrightarrow=bind(G,"\\overrightarrow","span",'class="mq-non-leaf mq-overarrow mq-arrow-right"'),f.overleftarrow=bind(G,"\\overleftarrow","span",'class="mq-non-leaf mq-overarrow mq-arrow-left"'),f.overleftrightarrow=bind(G,"\\overleftrightarrow","span",'class="mq-non-leaf mq-overarrow mq-arrow-both"'),f.overarc=bind(G,"\\overarc","span",'class="mq-non-leaf mq-overarc"'),f.dot=l(S,function(t,e){t.init=function(){e.init.call(this,"\\dot",'<span class="mq-non-leaf"><span class="mq-dot-recurring-inner"><span class="mq-dot-recurring">&#x2d9;</span><span class="mq-empty-box">&0</span></span></span>')}}),f.textcolor=l(S,function(t,e){t.setColor=function(t){this.color=t,this.htmlTemplate='<span class="mq-textcolor" style="color:'+t+'">&0</span>'},t.latex=function(){return"\\textcolor{"+this.color+"}{"+this.blocks[0].latex()+"}"},t.parser=function(){var t=this,n=j.optWhitespace,i=j.string,s=j.regex;return n.then(i("{")).then(s(/^[#\w\s.,()%-]*/)).skip(i("}")).then(function(n){return t.setColor(n),e.parser.call(t)})},t.isStyleBlock=function(){return!0}}),f.class=l(S,function(t,e){t.parser=function(){var t=this,n=j.string,i=j.regex;return j.optWhitespace.then(n("{")).then(i(/^[-\w\s\\\xA0-\xFF]*/)).skip(n("}")).then(function(n){return t.cls=n||"",t.htmlTemplate='<span class="mq-class '+n+'">&0</span>',e.parser.call(t)})},t.latex=function(){return"\\class{"+this.cls+"}{"+this.blocks[0].latex()+"}"},t.isStyleBlock=function(){return!0}});var Y=l(S,function(t,e){t.ctrlSeq="_{...}^{...}",t.createLeftOf=function(t){if(this.replacedFragment||t[-1]||!t.options.supSubsRequireOperand)return e.createLeftOf.apply(this,arguments)},t.contactWeld=function(t){for(var e=-1;e;e=-1===e&&1)if(this[e]instanceof Y){for(var n="sub";n;n="sub"===n&&"sup"){var i=this[n],s=this[e][n];if(i){if(s){if(i.isEmpty())var r=h(s,0,s.ends[-1]);else{i.jQ.children().insAtDirEnd(-e,s.jQ);var o=i.children().disown(),r=h(s,o.ends[1],s.ends[-1]);-1===e?o.adopt(s,s.ends[1],0):o.adopt(s,0,s.ends[-1])}}else this[e].addBlock(i.disown());this.placeCursor=function(t,n){return function(i){i.insAtDirEnd(-e,t||n)}}(s,i)}}this.remove(),t&&t[-1]===this&&(1===e&&r?r[-1]?t.insRightOf(r[-1]):t.insAtLeftEnd(r.parent):t.insRightOf(this[e]));break}},w.p.charsThatBreakOutOfSupSub="",t.finalizeTree=function(){this.ends[-1].write=function(t,e){if(t.options.autoSubscriptNumerals&&this===this.parent.sub){if("_"===e)return;var n=this.chToCmd(e,t.options);return n instanceof E?t.deleteSelection():t.clearSelection().insRightOf(this.parent),n.createLeftOf(t.show())}t[-1]&&!t[1]&&!t.selection&&t.options.charsThatBreakOutOfSupSub.indexOf(e)>-1&&t.insRightOf(this.parent),M.p.write.apply(this,arguments)}},t.moveTowards=function(t,n,i){n.options.autoSubscriptNumerals&&!this.sup?n.insDirOf(t,this):e.moveTowards.apply(this,arguments)},t.deleteTowards=function(t,n){if(n.options.autoSubscriptNumerals&&this.sub){var i=this.sub.ends[-t];i instanceof E?i.remove():i&&i.deleteTowards(t,n.insAtDirEnd(-t,this.sub)),this.sub.isEmpty()&&(this.sub.deleteOutOf(-1,n.insAtLeftEnd(this.sub)),this.sup&&n.insDirOf(-t,this))}else e.deleteTowards.apply(this,arguments)},t.latex=function(){function latex(t,e){var n=e&&e.latex();return e?t+(1===n.length?n:"{"+(n||" ")+"}"):""}return latex("_",this.sub)+latex("^",this.sup)},t.addBlock=function(t){"sub"===this.supsub?(this.sup=this.upInto=this.sub.upOutOf=t,t.adopt(this,this.sub,0).downOutOf=this.sub,t.jQ=c('<span class="mq-sup"/>').append(t.jQ.children()).attr(i,t.id).prependTo(this.jQ)):(this.sub=this.downInto=this.sup.downOutOf=t,t.adopt(this,0,this.sup).upOutOf=this.sup,t.jQ=c('<span class="mq-sub"></span>').append(t.jQ.children()).attr(i,t.id).appendTo(this.jQ.removeClass("mq-sup-only")),this.jQ.append('<span style="display:inline-block;width:0">&#8203;</span>'));for(var e=0;e<2;e+=1)!function(t,e,n,i){t[e].deleteOutOf=function(s,r){if(r.insDirOf(this[s]?-s:s,this.parent),!this.isEmpty()){var o=this.ends[s];this.children().disown().withDirAdopt(s,r.parent,r[s],r[-s]).jQ.insDirOf(-s,r.jQ),r[-s]=o}t.supsub=n,delete t[e],delete t[i+"Into"],t[n][i+"OutOf"]=insLeftOfMeUnlessAtEnd,delete t[n].deleteOutOf,"sub"===e&&c(t.jQ.addClass("mq-sup-only")[0].lastChild).remove(),this.remove()}}(this,"sub sup".split(" ")[e],"sup sub".split(" ")[e],"down up".split(" ")[e])},t.reflow=function(){var t=this.jQ,e=t.prev();if(e.length){var n=t.children(".mq-sup");if(n.length){var i=parseInt(n.css("font-size")),s=n.offset().top+n.height()-e.offset().top-.7*i,r=parseInt(n.css("margin-bottom"));n.css("margin-bottom",r+s)}}}});function insLeftOfMeUnlessAtEnd(t){var e=this.parent,n=t;do{if(n[1])return t.insLeftOf(e);n=n.parent.parent}while(n!==e);t.insRightOf(e)}f.subscript=f._=l(Y,function(t,e){t.supsub="sub",t.htmlTemplate='<span class="mq-supsub mq-non-leaf"><span class="mq-sub">&0</span><span style="display:inline-block;width:0">&#8203;</span></span>',t.textTemplate=["_"],t.finalizeTree=function(){this.downInto=this.sub=this.ends[-1],this.sub.upOutOf=insLeftOfMeUnlessAtEnd,e.finalizeTree.call(this)}}),f.superscript=f.supscript=f["^"]=l(Y,function(t,e){t.supsub="sup",t.htmlTemplate='<span class="mq-supsub mq-non-leaf mq-sup-only"><span class="mq-sup">&0</span></span>',t.textTemplate=["^"],t.finalizeTree=function(){this.upInto=this.sup=this.ends[1],this.sup.downOutOf=insLeftOfMeUnlessAtEnd,e.finalizeTree.call(this)}});var Z=l(S,function(t,e){t.init=function(t,e){E.prototype.init.call(this,t,'<span class="mq-large-operator mq-non-leaf"><span class="mq-to"><span>&1</span></span><big>'+e+'</big><span class="mq-from"><span>&0</span></span></span>')},t.createLeftOf=function(t){e.createLeftOf.apply(this,arguments),t.options.sumStartsWithNEquals&&(tc("n").createLeftOf(t),tq().createLeftOf(t))},t.latex=function(){function simplify(t){return 1===t.length?t:"{"+(t||" ")+"}"}return this.ctrlSeq+"_"+simplify(this.ends[-1].latex())+"^"+simplify(this.ends[1].latex())},t.parser=function(){for(var t=j.string,e=j.optWhitespace,n=j.succeed,i=D.block,s=this,r=s.blocks=[M(),M()],o=0;o<r.length;o+=1)r[o].adopt(s,s.ends[1],0);return e.then(t("_").or(t("^"))).then(function(t){var e=r["_"===t?0:1];return i.then(function(t){return t.children().adopt(e,e.ends[1],0),n(s)})}).many().result(s)},t.finalizeTree=function(){this.downInto=this.ends[-1],this.upInto=this.ends[1],this.ends[-1].upOutOf=this.ends[1],this.ends[1].downOutOf=this.ends[-1]}});f["∑"]=f.sum=f.summation=bind(Z,"\\sum ","&sum;"),f["∏"]=f.prod=f.product=bind(Z,"\\prod ","&prod;"),f.coprod=f.coproduct=bind(Z,"\\coprod ","&#8720;"),f["∫"]=f.int=f.integral=l(Z,function(t,e){t.init=function(){E.prototype.init.call(this,"\\int ",'<span class="mq-int mq-non-leaf"><big>&int;</big><span class="mq-supsub mq-non-leaf"><span class="mq-sup"><span class="mq-sup-inner">&1</span></span><span class="mq-sub">&0</span><span style="display:inline-block;width:0">&#8203</span></span></span>')},t.createLeftOf=S.p.createLeftOf});var X=f.frac=f.dfrac=f.cfrac=f.fraction=l(S,function(t,e){t.ctrlSeq="\\frac",t.htmlTemplate='<span class="mq-fraction mq-non-leaf"><span class="mq-numerator">&0</span><span class="mq-denominator">&1</span><span style="display:inline-block;width:0">&#8203;</span></span>',t.textTemplate=["(",")/(",")"],t.finalizeTree=function(){this.upInto=this.ends[1].upOutOf=this.ends[-1],this.downInto=this.ends[-1].downOutOf=this.ends[1]}}),J=f.over=p["/"]=l(X,function(t,e){t.createLeftOf=function(t){if(!this.replacedFragment){for(var n=t[-1];n&&!(n instanceof L||n instanceof(f.text||noop)||n instanceof Z||"\\ "===n.ctrlSeq||/^[,;:]$/.test(n.ctrlSeq));)n=n[-1];n instanceof Z&&n[1]instanceof Y&&(n=n[1])[1]instanceof Y&&n[1].ctrlSeq!=n.ctrlSeq&&(n=n[1]),n===t[-1]||t.isTooDeep(1)||(this.replaces(d(n[1]||t.parent.ends[-1],t[-1])),t[-1]=n)}e.createLeftOf.call(this,t)}}),tt=f.sqrt=f["√"]=l(S,function(t,e){t.ctrlSeq="\\sqrt",t.htmlTemplate='<span class="mq-non-leaf"><span class="mq-scaled mq-sqrt-prefix">&radic;</span><span class="mq-non-leaf mq-sqrt-stem">&0</span></span>',t.textTemplate=["sqrt(",")"],t.parser=function(){return D.optBlock.then(function(t){return D.block.map(function(e){var n=te();return n.blocks=[t,e],t.adopt(n,0,0),e.adopt(n,t,0),n})}).or(e.parser.call(this))},t.reflow=function(){var t=this.ends[1].jQ;$(t.prev(),1,t.innerHeight()/+t.css("fontSize").slice(0,-2)-.1)}});f.hat=l(S,function(t,e){t.ctrlSeq="\\hat",t.htmlTemplate='<span class="mq-non-leaf"><span class="mq-hat-prefix">^</span><span class="mq-hat-stem">&0</span></span>',t.textTemplate=["hat(",")"]});var te=f.nthroot=l(tt,function(t,e){t.htmlTemplate='<sup class="mq-nthroot mq-non-leaf">&0</sup><span class="mq-scaled"><span class="mq-sqrt-prefix mq-scaled">&radic;</span><span class="mq-sqrt-stem mq-non-leaf">&1</span></span>',t.textTemplate=["sqrt[","](",")"],t.latex=function(){return"\\sqrt["+this.ends[-1].latex()+"]{"+this.ends[1].latex()+"}"}}),tn=l(S,function(t,e){t.init=function(t,n,i){e.init.call(this,t,'<span class="mq-non-leaf"><span class="mq-diacritic-above">'+n+'</span><span class="mq-diacritic-stem">&0</span></span>',i)}});function DelimsMixin(t,e){t.jQadd=function(){e.jQadd.apply(this,arguments),this.delimjQs=this.jQ.children(":first").add(this.jQ.children(":last")),this.contentjQ=this.jQ.children(":eq(1)")},t.reflow=function(){var t=this.contentjQ.outerHeight()/parseFloat(this.contentjQ.css("fontSize"));$(this.delimjQs,s(1+.2*(t-1),1.2),1.2*t)}}f.vec=bind(tn,"\\vec","&rarr;",["vec(",")"]),f.tilde=bind(tn,"\\tilde","~",["tilde(",")"]);var ti=l(l(S,DelimsMixin),function(e,n){e.init=function(e,i,s,r,o){n.init.call(this,"\\left"+r,t,[i,s]),this.side=e,this.sides={},this.sides[-1]={ch:i,ctrlSeq:r},this.sides[1]={ch:s,ctrlSeq:o}},e.numBlocks=function(){return 1},e.html=function(){return this.htmlTemplate='<span class="mq-non-leaf"><span class="mq-scaled mq-paren'+(1===this.side?" mq-ghost":"")+'">'+this.sides[-1].ch+'</span><span class="mq-non-leaf">&0</span><span class="mq-scaled mq-paren'+(-1===this.side?" mq-ghost":"")+'">'+this.sides[1].ch+"</span></span>",n.html.call(this)},e.latex=function(){return"\\left"+this.sides[-1].ctrlSeq+this.ends[-1].latex()+"\\right"+this.sides[1].ctrlSeq},e.matchBrack=function(t,e,n){return n instanceof ti&&n.side&&n.side!==-e&&(!t.restrictMismatchedBrackets||ts[this.sides[this.side].ch]===n.sides[n.side].ch||({"(":"]","[":")"})[this.sides[-1].ch]===n.sides[1].ch)&&n},e.closeOpposing=function(t){t.side=0,t.sides[this.side]=this.sides[this.side],t.delimjQs.eq(-1===this.side?0:1).removeClass("mq-ghost").html(this.sides[this.side].ch)},e.createLeftOf=function(t){if(!this.replacedFragment){var e=t.options;if("|"===this.sides[-1].ch)var i=this.matchBrack(e,1,t[1])||this.matchBrack(e,-1,t[-1])||this.matchBrack(e,0,t.parent.parent);else var i=this.matchBrack(e,-this.side,t[-this.side])||this.matchBrack(e,-this.side,t.parent.parent)}if(i){var s=this.side=-i.side;this.closeOpposing(i),i===t.parent.parent&&t[s]&&d(t[s],t.parent.ends[s],-s).disown().withDirAdopt(-s,i.parent,i,i[s]).jQ.insDirOf(s,i.jQ),i.bubble("reflow")}else i=this,s=i.side,i.replacedFragment?i.side=0:t[-s]&&(i.replaces(d(t[-s],t.parent.ends[-s],s)),t[-s]=0),n.createLeftOf.call(i,t);-1===s?t.insAtLeftEnd(i.ends[-1]):t.insRightOf(i)},e.placeCursor=noop,e.unwrap=function(){this.ends[-1].children().disown().adopt(this.parent,this,this[1]).jQ.insertAfter(this.jQ),this.remove()},e.deleteSide=function(t,e,n){var i=this.parent,s=this[t],r=i.ends[t];if(t===this.side){this.unwrap(),s?n.insDirOf(-t,s):n.insAtDirEnd(t,i);return}var o=n.options,a=!this.side;if(this.side=-t,this.matchBrack(o,t,this.ends[-1].ends[this.side])){this.closeOpposing(this.ends[-1].ends[this.side]);var l=this.ends[-1].ends[t];this.unwrap(),l.siblingCreated&&l.siblingCreated(n.options,t),s?n.insDirOf(-t,s):n.insAtDirEnd(t,i)}else{if(this.matchBrack(o,t,this.parent.parent))this.parent.parent.closeOpposing(this),this.parent.parent.unwrap();else if(e&&a){this.unwrap(),s?n.insDirOf(-t,s):n.insAtDirEnd(t,i);return}else this.sides[t]={ch:ts[this.sides[this.side].ch],ctrlSeq:ts[this.sides[this.side].ctrlSeq]},this.delimjQs.removeClass("mq-ghost").eq(-1===t?0:1).addClass("mq-ghost").html(this.sides[t].ch);if(s){var l=this.ends[-1].ends[t];d(s,r,-t).disown().withDirAdopt(-t,this.ends[-1],l,0).jQ.insAtDirEnd(t,this.ends[-1].jQ.removeClass("mq-empty")),l.siblingCreated&&l.siblingCreated(n.options,t),n.insDirOf(-t,s)}else e?n.insDirOf(t,this):n.insAtDirEnd(t,this.ends[-1])}},e.deleteTowards=function(t,e){this.deleteSide(-t,!1,e)},e.finalizeTree=function(){this.ends[-1].deleteOutOf=function(t,e){this.parent.deleteSide(t,!0,e)},this.finalizeTree=this.intentionalBlur=function(){this.delimjQs.eq(-1===this.side?1:0).removeClass("mq-ghost"),this.side=0}},e.siblingCreated=function(t,e){e===-this.side&&this.finalizeTree()}}),ts={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{","\\{":"\\}","\\}":"\\{","&lang;":"&rang;","&rang;":"&lang;","\\langle ":"\\rangle ","\\rangle ":"\\langle ","|":"|","\\lVert ":"\\rVert ","\\rVert ":"\\lVert "};function bindCharBracketPair(t,e){var e=e||t,n=ts[t],i=ts[e];p[t]=bind(ti,-1,t,n,e,i),p[n]=bind(ti,1,t,n,e,i)}bindCharBracketPair("("),bindCharBracketPair("["),bindCharBracketPair("{","\\{"),f.langle=bind(ti,-1,"&lang;","&rang;","\\langle ","\\rangle "),f.rangle=bind(ti,1,"&lang;","&rang;","\\langle ","\\rangle "),p["|"]=bind(ti,-1,"|","|","|","|"),f.lVert=bind(ti,-1,"&#8741;","&#8741;","\\lVert ","\\rVert "),f.rVert=bind(ti,1,"&#8741;","&#8741;","\\lVert ","\\rVert "),f.left=l(S,function(t){t.parser=function(){var t=j.regex,e=j.string;j.succeed;var n=j.optWhitespace;return n.then(t(/^(?:[([|]|\\\{|\\langle(?![a-zA-Z])|\\lVert(?![a-zA-Z]))/)).then(function(i){var s="\\"===i.charAt(0)?i.slice(1):i;return"\\langle"==i&&(s="&lang;",i+=" "),"\\lVert"==i&&(s="&#8741;",i+=" "),D.then(function(r){return e("\\right").skip(n).then(t(/^(?:[\])|]|\\\}|\\rangle(?![a-zA-Z])|\\rVert(?![a-zA-Z]))/)).map(function(t){var e="\\"===t.charAt(0)?t.slice(1):t;"\\rangle"==t&&(e="&rang;",t+=" "),"\\rVert"==t&&(e="&#8741;",t+=" ");var n=ti(0,s,e,i,t);return n.blocks=[r],r.adopt(n,0,0),n})})})}}),f.right=l(S,function(t){t.parser=function(){return j.fail("unmatched \\right")}});var tr=f.binom=f.binomial=l(l(S,DelimsMixin),function(t,e){t.ctrlSeq="\\binom",t.htmlTemplate='<span class="mq-non-leaf"><span class="mq-paren mq-scaled">(</span><span class="mq-non-leaf"><span class="mq-array mq-non-leaf"><span>&0</span><span>&1</span></span></span><span class="mq-paren mq-scaled">)</span></span>',t.textTemplate=["choose(",",",")"]});f.choose=l(tr,function(t){t.createLeftOf=J.prototype.createLeftOf}),f.editable=f.MathQuillMathField=l(S,function(t,e){t.ctrlSeq="\\MathQuillMathField",t.htmlTemplate='<span class="mq-editable-field"><span class="mq-root-block">&0</span></span>',t.parser=function(){var t=this,n=j.string,i=j.regex,s=j.succeed;return n("[").then(i(/^[a-z][a-z0-9]*/i)).skip(n("]")).map(function(e){t.name=e}).or(s()).then(e.parser.call(t))},t.finalizeTree=function(t){var e=g(this.ends[-1],this.jQ,t);e.KIND_OF_MQ="MathField",e.editable=!0,e.createTextarea(),e.editablesTextareaEvents(),e.cursor.insAtRightEnd(e.root),RootBlockMixin(e.root)},t.registerInnerField=function(t,e){t.push(t[this.name]=e(this.ends[-1].controller))},t.latex=function(){return this.ends[-1].latex()},t.text=function(){return this.ends[-1].text()}});var to=f.embed=l(E,function(t,e){t.setOptions=function(t){function noop(){return""}return this.text=t.text||noop,this.htmlTemplate=t.htmlString||"",this.latex=t.latex||noop,this},t.parser=function(){var t=this,e=j.string,n=j.regex,i=j.succeed;return e("{").then(n(/^[a-z][a-z0-9]*/i)).skip(e("}")).then(function(s){return e("[").then(n(/^[-\w\s]*/)).skip(e("]")).or(i()).map(function(e){return t.setOptions(y[s](e))})})}});f.notin=f.cong=f.equiv=f.oplus=f.otimes=l(L,function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}}),f["≠"]=f.ne=f.neq=bind(L,"\\ne ","&ne;"),f["∗"]=f.ast=f.star=f.loast=f.lowast=bind(L,"\\ast ","&lowast;"),f.therefor=f.therefore=bind(L,"\\therefore ","&there4;"),f.cuz=f.because=bind(L,"\\because ","&#8757;"),f.prop=f.propto=bind(L,"\\propto ","&prop;"),f["≈"]=f.asymp=f.approx=bind(L,"\\approx ","&asymp;"),f.isin=f.in=bind(L,"\\in ","&isin;"),f.ni=f.contains=bind(L,"\\ni ","&ni;"),f.notni=f.niton=f.notcontains=f.doesnotcontain=bind(L,"\\not\\ni ","&#8716;"),f.sub=f.subset=bind(L,"\\subset ","&sub;"),f.sup=f.supset=f.superset=bind(L,"\\supset ","&sup;"),f.nsub=f.notsub=f.nsubset=f.notsubset=bind(L,"\\not\\subset ","&#8836;"),f.nsup=f.notsup=f.nsupset=f.notsupset=f.nsuperset=f.notsuperset=bind(L,"\\not\\supset ","&#8837;"),f.sube=f.subeq=f.subsete=f.subseteq=bind(L,"\\subseteq ","&sube;"),f.supe=f.supeq=f.supsete=f.supseteq=f.supersete=f.superseteq=bind(L,"\\supseteq ","&supe;"),f.nsube=f.nsubeq=f.notsube=f.notsubeq=f.nsubsete=f.nsubseteq=f.notsubsete=f.notsubseteq=bind(L,"\\not\\subseteq ","&#8840;"),f.nsupe=f.nsupeq=f.notsupe=f.notsupeq=f.nsupsete=f.nsupseteq=f.notsupsete=f.notsupseteq=f.nsupersete=f.nsuperseteq=f.notsupersete=f.notsuperseteq=bind(L,"\\not\\supseteq ","&#8841;"),f.N=f.naturals=f.Naturals=bind(A,"\\mathbb{N}","&#8469;"),f.P=f.primes=f.Primes=f.projective=f.Projective=f.probability=f.Probability=bind(A,"\\mathbb{P}","&#8473;"),f.Z=f.integers=f.Integers=bind(A,"\\mathbb{Z}","&#8484;"),f.Q=f.rationals=f.Rationals=bind(A,"\\mathbb{Q}","&#8474;"),f.R=f.reals=f.Reals=bind(A,"\\mathbb{R}","&#8477;"),f.C=f.complex=f.Complex=f.complexes=f.Complexes=f.complexplane=f.Complexplane=f.ComplexPlane=bind(A,"\\mathbb{C}","&#8450;"),f.H=f.Hamiltonian=f.quaternions=f.Quaternions=bind(A,"\\mathbb{H}","&#8461;"),f.quad=f.emsp=bind(A,"\\quad ","    "),f.qquad=bind(A,"\\qquad ","        "),f.diamond=bind(A,"\\diamond ","&#9671;"),f.bigtriangleup=bind(A,"\\bigtriangleup ","&#9651;"),f.ominus=bind(A,"\\ominus ","&#8854;"),f.uplus=bind(A,"\\uplus ","&#8846;"),f.bigtriangledown=bind(A,"\\bigtriangledown ","&#9661;"),f.sqcap=bind(A,"\\sqcap ","&#8851;"),f.triangleleft=bind(A,"\\triangleleft ","&#8882;"),f.sqcup=bind(A,"\\sqcup ","&#8852;"),f.triangleright=bind(A,"\\triangleright ","&#8883;"),f.odot=f.circledot=bind(A,"\\odot ","&#8857;"),f.bigcirc=bind(A,"\\bigcirc ","&#9711;"),f.dagger=bind(A,"\\dagger ","&#0134;"),f.ddagger=bind(A,"\\ddagger ","&#135;"),f.wr=bind(A,"\\wr ","&#8768;"),f.amalg=bind(A,"\\amalg ","&#8720;"),f.models=bind(A,"\\models ","&#8872;"),f.prec=bind(A,"\\prec ","&#8826;"),f.succ=bind(A,"\\succ ","&#8827;"),f.preceq=bind(A,"\\preceq ","&#8828;"),f.succeq=bind(A,"\\succeq ","&#8829;"),f.simeq=bind(A,"\\simeq ","&#8771;"),f.mid=bind(A,"\\mid ","&#8739;"),f.ll=bind(A,"\\ll ","&#8810;"),f.gg=bind(A,"\\gg ","&#8811;"),f.parallel=bind(A,"\\parallel ","&#8741;"),f.nparallel=bind(A,"\\nparallel ","&#8742;"),f.bowtie=bind(A,"\\bowtie ","&#8904;"),f.sqsubset=bind(A,"\\sqsubset ","&#8847;"),f.sqsupset=bind(A,"\\sqsupset ","&#8848;"),f.smile=bind(A,"\\smile ","&#8995;"),f.sqsubseteq=bind(A,"\\sqsubseteq ","&#8849;"),f.sqsupseteq=bind(A,"\\sqsupseteq ","&#8850;"),f.doteq=bind(A,"\\doteq ","&#8784;"),f.frown=bind(A,"\\frown ","&#8994;"),f.vdash=bind(A,"\\vdash ","&#8870;"),f.dashv=bind(A,"\\dashv ","&#8867;"),f.nless=bind(A,"\\nless ","&#8814;"),f.ngtr=bind(A,"\\ngtr ","&#8815;"),f.longleftarrow=bind(A,"\\longleftarrow ","&#8592;"),f.longrightarrow=bind(A,"\\longrightarrow ","&#8594;"),f.Longleftarrow=bind(A,"\\Longleftarrow ","&#8656;"),f.Longrightarrow=bind(A,"\\Longrightarrow ","&#8658;"),f.longleftrightarrow=bind(A,"\\longleftrightarrow ","&#8596;"),f.updownarrow=bind(A,"\\updownarrow ","&#8597;"),f.Longleftrightarrow=bind(A,"\\Longleftrightarrow ","&#8660;"),f.Updownarrow=bind(A,"\\Updownarrow ","&#8661;"),f.mapsto=bind(A,"\\mapsto ","&#8614;"),f.nearrow=bind(A,"\\nearrow ","&#8599;"),f.hookleftarrow=bind(A,"\\hookleftarrow ","&#8617;"),f.hookrightarrow=bind(A,"\\hookrightarrow ","&#8618;"),f.searrow=bind(A,"\\searrow ","&#8600;"),f.leftharpoonup=bind(A,"\\leftharpoonup ","&#8636;"),f.rightharpoonup=bind(A,"\\rightharpoonup ","&#8640;"),f.swarrow=bind(A,"\\swarrow ","&#8601;"),f.leftharpoondown=bind(A,"\\leftharpoondown ","&#8637;"),f.rightharpoondown=bind(A,"\\rightharpoondown ","&#8641;"),f.nwarrow=bind(A,"\\nwarrow ","&#8598;"),f.ldots=bind(A,"\\ldots ","&#8230;"),f.cdots=bind(A,"\\cdots ","&#8943;"),f.vdots=bind(A,"\\vdots ","&#8942;"),f.ddots=bind(A,"\\ddots ","&#8945;"),f.surd=bind(A,"\\surd ","&#8730;"),f.triangle=bind(A,"\\triangle ","&#9651;"),f.ell=bind(A,"\\ell ","&#8467;"),f.top=bind(A,"\\top ","&#8868;"),f.flat=bind(A,"\\flat ","&#9837;"),f.natural=bind(A,"\\natural ","&#9838;"),f.sharp=bind(A,"\\sharp ","&#9839;"),f.wp=bind(A,"\\wp ","&#8472;"),f.bot=bind(A,"\\bot ","&#8869;"),f.clubsuit=bind(A,"\\clubsuit ","&#9827;"),f.diamondsuit=bind(A,"\\diamondsuit ","&#9826;"),f.heartsuit=bind(A,"\\heartsuit ","&#9825;"),f.spadesuit=bind(A,"\\spadesuit ","&#9824;"),f.parallelogram=bind(A,"\\parallelogram ","&#9649;"),f.square=bind(A,"\\square ","&#11036;"),f.oint=bind(A,"\\oint ","&#8750;"),f.bigcap=bind(A,"\\bigcap ","&#8745;"),f.bigcup=bind(A,"\\bigcup ","&#8746;"),f.bigsqcup=bind(A,"\\bigsqcup ","&#8852;"),f.bigvee=bind(A,"\\bigvee ","&#8744;"),f.bigwedge=bind(A,"\\bigwedge ","&#8743;"),f.bigodot=bind(A,"\\bigodot ","&#8857;"),f.bigotimes=bind(A,"\\bigotimes ","&#8855;"),f.bigoplus=bind(A,"\\bigoplus ","&#8853;"),f.biguplus=bind(A,"\\biguplus ","&#8846;"),f.lfloor=bind(A,"\\lfloor ","&#8970;"),f.rfloor=bind(A,"\\rfloor ","&#8971;"),f.lceil=bind(A,"\\lceil ","&#8968;"),f.rceil=bind(A,"\\rceil ","&#8969;"),f.opencurlybrace=f.lbrace=bind(A,"\\lbrace ","{"),f.closecurlybrace=f.rbrace=bind(A,"\\rbrace ","}"),f.lbrack=bind(A,"["),f.rbrack=bind(A,"]"),f.slash=bind(A,"/"),f.vert=bind(A,"|"),f.perp=f.perpendicular=bind(A,"\\perp ","&perp;"),f.nabla=f.del=bind(A,"\\nabla ","&nabla;"),f.hbar=bind(A,"\\hbar ","&#8463;"),f.AA=f.Angstrom=f.angstrom=bind(A,"\\text\\AA ","&#8491;"),f.ring=f.circ=f.circle=bind(A,"\\circ ","&#8728;"),f.bull=f.bullet=bind(A,"\\bullet ","&bull;"),f.setminus=f.smallsetminus=bind(A,"\\setminus ","&#8726;"),f.not=f["\xac"]=f.neg=bind(A,"\\neg ","&not;"),f["…"]=f.dots=f.ellip=f.hellip=f.ellipsis=f.hellipsis=bind(A,"\\dots ","&hellip;"),f.converges=f.darr=f.dnarr=f.dnarrow=f.downarrow=bind(A,"\\downarrow ","&darr;"),f.dArr=f.dnArr=f.dnArrow=f.Downarrow=bind(A,"\\Downarrow ","&dArr;"),f.diverges=f.uarr=f.uparrow=bind(A,"\\uparrow ","&uarr;"),f.uArr=f.Uparrow=bind(A,"\\Uparrow ","&uArr;"),f.to=bind(L,"\\to ","&rarr;"),f.rarr=f.rightarrow=bind(A,"\\rightarrow ","&rarr;"),f.implies=bind(L,"\\Rightarrow ","&rArr;"),f.rArr=f.Rightarrow=bind(A,"\\Rightarrow ","&rArr;"),f.gets=bind(L,"\\gets ","&larr;"),f.larr=f.leftarrow=bind(A,"\\leftarrow ","&larr;"),f.impliedby=bind(L,"\\Leftarrow ","&lArr;"),f.lArr=f.Leftarrow=bind(A,"\\Leftarrow ","&lArr;"),f.harr=f.lrarr=f.leftrightarrow=bind(A,"\\leftrightarrow ","&harr;"),f.iff=bind(L,"\\Leftrightarrow ","&hArr;"),f.hArr=f.lrArr=f.Leftrightarrow=bind(A,"\\Leftrightarrow ","&hArr;"),f.Re=f.Real=f.real=bind(A,"\\Re ","&real;"),f.Im=f.imag=f.image=f.imagin=f.imaginary=f.Imaginary=bind(A,"\\Im ","&image;"),f.part=f.partial=bind(A,"\\partial ","&part;"),f.infty=f.infin=f.infinity=bind(A,"\\infty ","&infin;"),f.pounds=bind(A,"\\pounds ","&pound;"),f.alef=f.alefsym=f.aleph=f.alephsym=bind(A,"\\aleph ","&alefsym;"),f.xist=f.xists=f.exist=f.exists=bind(A,"\\exists ","&exist;"),f.nexists=f.nexist=bind(A,"\\nexists ","&#8708;"),f.and=f.land=f.wedge=bind(L,"\\wedge ","&and;"),f.or=f.lor=f.vee=bind(L,"\\vee ","&or;"),f.o=f.O=f.empty=f.emptyset=f.oslash=f.Oslash=f.nothing=f.varnothing=bind(L,"\\varnothing ","&empty;"),f.cup=f.union=bind(L,"\\cup ","&cup;"),f.cap=f.intersect=f.intersection=bind(L,"\\cap ","&cap;"),f.deg=f.degree=bind(A,"\\degree ","&deg;"),f.ang=f.angle=bind(A,"\\angle ","&ang;"),f.measuredangle=bind(A,"\\measuredangle ","&#8737;");var ta=l(A,function(t,e){t.createLeftOf=function(t){t.options.autoSubscriptNumerals&&t.parent!==t.parent.parent.sub&&(t[-1]instanceof tl&&!1!==t[-1].isItalic||t[-1]instanceof Y&&t[-1][-1]instanceof tl&&!1!==t[-1][-1].isItalic)?(f._().createLeftOf(t),e.createLeftOf.call(this,t),t.insRightOf(t.parent.parent)):e.createLeftOf.call(this,t)}}),tl=l(E,function(t,e){t.init=function(t,n){e.init.call(this,t,"<var>"+(n||t)+"</var>")},t.text=function(){var t=this.ctrlSeq;return this.isPartOfOperator?"\\"==t[0]?t=t.slice(1,t.length):" "==t[t.length-1]&&(t=t.slice(0,-1)):(!this[-1]||this[-1]instanceof tl||this[-1]instanceof L||"\\ "===this[-1].ctrlSeq||(t="*"+t),!this[1]||this[1]instanceof L||this[1]instanceof Y||(t+="*")),t}});w.p.autoCommands={_maxLength:0},x.autoCommands=function(t){if(!/^[a-z]+(?: [a-z]+)*$/i.test(t))throw'"'+t+'" not a space-delimited list of only letters';for(var e=t.split(" "),n={},i=0,s=0;s<e.length;s+=1){var o=e[s];if(o.length<2)throw'autocommand "'+o+'" not minimum length of 2';if(f[o]===tf)throw'"'+o+'" is a built-in operator name';n[o]=1,i=r(i,o.length)}return n._maxLength=i,n};var tc=l(tl,function(t,e){function shouldOmitPadding(t){return!t||t instanceof L||t instanceof Z}t.init=function(t){return e.init.call(this,this.letter=t)},t.createLeftOf=function(t){e.createLeftOf.apply(this,arguments);var n=t.options.autoCommands,i=n._maxLength;if(i>0){for(var s="",r=this,o=0;r instanceof tc&&r.ctrlSeq===r.letter&&o<i;)s=r.letter+s,r=r[-1],o+=1;for(;s.length;){if(n.hasOwnProperty(s)){for(var o=1,r=this;o<s.length;o+=1,r=r[-1]);return d(r,this).remove(),t[-1]=r[-1],f[s](s).createLeftOf(t)}s=s.slice(1)}}},t.italicize=function(t){return this.isItalic=t,this.isPartOfOperator=!t,this.jQ.toggleClass("mq-operator-name",!t),this},t.finalizeTree=t.siblingDeleted=t.siblingCreated=function(t,e){-1!==e&&this[1]instanceof tc||this.autoUnItalicize(t)},t.autoUnItalicize=function(t){var e=t.autoOperatorNames;if(0!==e._maxLength){for(var n=this.letter,i=this[-1];i instanceof tc;i=i[-1])n=i.letter+n;for(var r=this[1];r instanceof tc;r=r[1])n+=r.letter;d(i[1]||this.parent.ends[-1],r[-1]||this.parent.ends[1]).each(function(t){t.italicize(!0).jQ.removeClass("mq-first mq-last mq-followed-by-supsub"),t.ctrlSeq=t.letter});t:for(var o=0,a=i[1]||this.parent.ends[-1];o<n.length;o+=1,a=a[1])for(var l=s(e._maxLength,n.length-o);l>0;l-=1){var c=n.slice(o,o+l);if(e.hasOwnProperty(c)){for(var h=0,u=a;h<l;h+=1,u=u[1]){u.italicize(!1);var f=u}var p=th.hasOwnProperty(c);if(a.ctrlSeq=(p?"\\":"\\operatorname{")+a.ctrlSeq,f.ctrlSeq+=p?" ":"}",td.hasOwnProperty(c)&&f[-1][-1][-1].jQ.addClass("mq-last"),shouldOmitPadding(a[-1])||a.jQ.addClass("mq-first"),!shouldOmitPadding(f[1])){if(f[1]instanceof Y){var m=f[1];(m.siblingCreated=m.siblingDeleted=function(){m.jQ.toggleClass("mq-after-operator-name",!(m[1]instanceof ti))})()}else f.jQ.toggleClass("mq-last",!(f[1]instanceof ti))}o+=l-1,a=f;continue t}}}}}),th={},tu=w.p.autoOperatorNames={_maxLength:9},td={limsup:1,liminf:1,projlim:1,injlim:1};!function(){for(var t="arg deg det dim exp gcd hom inf ker lg lim ln log max min sup limsup liminf injlim projlim Pr".split(" "),e=0;e<t.length;e+=1)th[t[e]]=tu[t[e]]=1;for(var n="sin cos tan arcsin arccos arctan sinh cosh tanh sec csc cot coth".split(" "),e=0;e<n.length;e+=1)th[n[e]]=1;for(var i="sin cos tan sec cosec csc cotan cot ctg".split(" "),e=0;e<i.length;e+=1)tu[i[e]]=tu["arc"+i[e]]=tu[i[e]+"h"]=tu["ar"+i[e]+"h"]=tu["arc"+i[e]+"h"]=1;for(var s="gcf hcf lcm proj span".split(" "),e=0;e<s.length;e+=1)tu[s[e]]=1}(),x.autoOperatorNames=function(t){if(!/^[a-z]+(?: [a-z]+)*$/i.test(t))throw'"'+t+'" not a space-delimited list of only letters';for(var e=t.split(" "),n={},i=0,s=0;s<e.length;s+=1){var o=e[s];if(o.length<2)throw'"'+o+'" not minimum length of 2';n[o]=1,i=r(i,o.length)}return n._maxLength=i,n};var tf=l(E,function(t,e){t.init=function(t){this.ctrlSeq=t},t.createLeftOf=function(t){for(var e=this.ctrlSeq,n=0;n<e.length;n+=1)tc(e.charAt(n)).createLeftOf(t)},t.parser=function(){for(var t=this.ctrlSeq,e=M(),n=0;n<t.length;n+=1)tc(t.charAt(n)).adopt(e,e.ends[1],0);return j.succeed(e.children())}});for(var tp in tu)tu.hasOwnProperty(tp)&&(f[tp]=tf);f.operatorname=l(S,function(t){t.createLeftOf=noop,t.numBlocks=function(){return 1},t.parser=function(){return D.block.map(function(t){return t.children()})}}),f.f=l(tc,function(t,e){t.init=function(){E.p.init.call(this,this.letter="f",'<var class="mq-f">f</var>')},t.italicize=function(t){return this.jQ.html("f").toggleClass("mq-f",t),e.italicize.apply(this,arguments)}}),f[" "]=f.space=bind(A,"\\ ","&nbsp;"),f["'"]=f.prime=bind(A,"'","&prime;"),f["″"]=f.dprime=bind(A,"″","&Prime;"),f.backslash=bind(A,"\\backslash ","\\"),p["\\"]||(p["\\"]=f.backslash),f.$=bind(A,"\\$","$");var tm=l(E,function(t,e){t.init=function(t,n){e.init.call(this,t,'<span class="mq-nonSymbola">'+(n||t)+"</span>")}});f["@"]=tm,f["&"]=bind(tm,"\\&","&amp;"),f["%"]=bind(tm,"\\%","%"),f.alpha=f.beta=f.gamma=f.delta=f.zeta=f.eta=f.theta=f.iota=f.kappa=f.mu=f.nu=f.xi=f.rho=f.sigma=f.tau=f.chi=f.psi=f.omega=l(tl,function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}}),f.phi=bind(tl,"\\phi ","&#981;"),f.phiv=f.varphi=bind(tl,"\\varphi ","&phi;"),f.epsilon=bind(tl,"\\epsilon ","&#1013;"),f.epsiv=f.varepsilon=bind(tl,"\\varepsilon ","&epsilon;"),f.piv=f.varpi=bind(tl,"\\varpi ","&piv;"),f.sigmaf=f.sigmav=f.varsigma=bind(tl,"\\varsigma ","&sigmaf;"),f.thetav=f.vartheta=f.thetasym=bind(tl,"\\vartheta ","&thetasym;"),f.upsilon=f.upsi=bind(tl,"\\upsilon ","&upsilon;"),f.gammad=f.Gammad=f.digamma=bind(tl,"\\digamma ","&#989;"),f.kappav=f.varkappa=bind(tl,"\\varkappa ","&#1008;"),f.rhov=f.varrho=bind(tl,"\\varrho ","&#1009;"),f.pi=f["π"]=bind(tm,"\\pi ","&pi;"),f.lambda=bind(tm,"\\lambda ","&lambda;"),f.Upsilon=f.Upsi=f.upsih=f.Upsih=bind(E,"\\Upsilon ",'<var style="font-family: serif">&upsih;</var>'),f.Gamma=f.Delta=f.Theta=f.Lambda=f.Xi=f.Pi=f.Sigma=f.Phi=f.Psi=f.Omega=f.forall=l(A,function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}});var tb=l(S,function(t){t.init=function(t){this.latex=t},t.createLeftOf=function(t){var e=D.parse(this.latex);e.children().adopt(t.parent,t[-1],t[1]),t[-1]=e.ends[1],e.jQize().insertBefore(t.jQ),e.finalizeInsert(t.options,t),e.ends[1][1].siblingCreated&&e.ends[1][1].siblingCreated(t.options,-1),e.ends[-1][-1].siblingCreated&&e.ends[-1][-1].siblingCreated(t.options,1),t.parent.bubble("reflow")},t.parser=function(){var t=D.parse(this.latex).children();return j.succeed(t)}});f["\xb9"]=bind(tb,"^1"),f["\xb2"]=bind(tb,"^2"),f["\xb3"]=bind(tb,"^3"),f["\xbc"]=bind(tb,"\\frac14"),f["\xbd"]=bind(tb,"\\frac12"),f["\xbe"]=bind(tb,"\\frac34");var tg=l(L,function(t){t.init=A.prototype.init,t.contactWeld=t.siblingCreated=t.siblingDeleted=function(t,e){if(1!==e)return this.jQ[0].className=function determineOpClassType(t){if(t[-1]){if(t[-1]instanceof L||/^[,;:\(\[]$/.test(t[-1].ctrlSeq))return""}else if(t.parent&&t.parent.parent&&t.parent.parent.isStyleBlock())return determineOpClassType(t.parent.parent);else return"";return"mq-binary-operator"}(this),this}});f["+"]=bind(tg,"+","+"),f["–"]=f["-"]=bind(tg,"-","&minus;"),f["\xb1"]=f.pm=f.plusmn=f.plusminus=bind(tg,"\\pm ","&plusmn;"),f.mp=f.mnplus=f.minusplus=bind(tg,"\\mp ","&#8723;"),p["*"]=f.sdot=f.cdot=bind(L,"\\cdot ","&middot;","*");var tv=l(L,function(t,e){t.init=function(t,n){this.data=t,this.strict=n;var i=n?"Strict":"";e.init.call(this,t["ctrlSeq"+i],t["html"+i],t["text"+i])},t.swap=function(t){this.strict=t;var e=t?"Strict":"";this.ctrlSeq=this.data["ctrlSeq"+e],this.jQ.html(this.data["html"+e]),this.textTemplate=[this.data["text"+e]]},t.deleteTowards=function(t,n){if(-1===t&&!this.strict){this.swap(!0),this.bubble("reflow");return}e.deleteTowards.apply(this,arguments)}}),tw={ctrlSeq:"\\le ",html:"&le;",text:"≤",ctrlSeqStrict:"<",htmlStrict:"&lt;",textStrict:"<"},tx={ctrlSeq:"\\ge ",html:"&ge;",text:"≥",ctrlSeqStrict:">",htmlStrict:"&gt;",textStrict:">"};f["<"]=f.lt=bind(tv,tw,!0),f[">"]=f.gt=bind(tv,tx,!0),f["≤"]=f.le=f.leq=bind(tv,tw,!1),f["≥"]=f.ge=f.geq=bind(tv,tx,!1);var tq=l(L,function(t,e){t.init=function(){e.init.call(this,"=","=")},t.createLeftOf=function(t){if(t[-1]instanceof tv&&t[-1].strict){t[-1].swap(!1),t[-1].bubble("reflow");return}e.createLeftOf.apply(this,arguments)}});f["="]=tq,f["\xd7"]=f.times=bind(L,"\\times ","&times;","[x]"),f["\xf7"]=f.div=f.divide=f.divides=bind(L,"\\div ","&divide;","[/]"),p["~"]=f.sim=bind(L,"\\sim ","~","~");var ty=getInterface(1);for(var tO in ty)!function(t,e){"function"==typeof e?(MathQuill[t]=function(){return insistOnInterVer(),e.apply(this,arguments)},MathQuill[t].prototype=e.prototype):MathQuill[t]=e}(tO,ty[tO])}()}}]);
{"version":3,"sources":["jquery.js","Editor.js","index.js","../../mathquill4quill.js"],"names":["window","jQuery","$","katex","Editor","reactQuill","React","createRef","mathquill4quill","Quill","enableMathQuillFormulaAuthoring","this","current","editor","props","options","ref","id","modules","formula","toolbar","placeholder","theme","Component","CUSTOM_OPERATORS","Index","useState","operators","setOperators","displayHistory","setDisplayHistory","className","JSON","stringify","type","onChange","event","target","checked","href","width","height","src","alt","ReactDOM","render","StrictMode","document","getElementById","dependencies","MathQuill","localStorage","getCacheItem","key","getItem","e","quill","getTooltip","container","getElementsByClassName","getLatexInput","getElementsByTagName","MutationObserver","console","log","tooltip","historyCacheKey","historyList","parse","fetchHistoryList","historySize","mqInput","autofocus","mathQuillConfig","cacheKey","mqField","latexInputStyle","syncMathquillToQuill","latexInput","saveButton","handlers","edit","latex","value","setItem","setCacheItem","enter","click","getInterface","MathField","cachedLatex","addEventListener","item","length","index","indexOf","splice","unshift","pop","addItemToHistoryList","removeItem","removeCacheItem","newNode","referenceNode","setAttribute","applyMathquillInputStyles","createElement","applyLatexInputStyles","setTimeout","focus","autofocusFormulaField","parentNode","insertBefore","nextSibling","destroy","remove","newMathquillInput","operatorButtons","applyOperatorContainerStyles","forEach","element","button","displayOperator","operator","throwOnError","onclick","test","isOperatorCommand","write","cmd","createOperatorButton","applyOperatorButtonStyles","appendChild","newOperatorButtons","historyListButtons","history","historyDiv","getBoundingClientRect","top","style","fixToolTipHeight","applyHistoryContainerStyles","header","innerHTML","createHistoryButton","applyHistoryButtonStyles","newHistoryList","classList","contains","attributes","observe","attributeFilter","module","exports","prototype"],"mappings":"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","file":"static/js/main.3e9492f4.chunk.js","sourcesContent":["import $ from \"jquery\";\n\nwindow.jQuery = window.$ = $;\n","// KaTeX dependency\nimport katex from \"katex\";\nwindow.katex = katex;\nimport \"katex/dist/katex.css\";\n\n// Quill dependency\nimport ReactQuill, { Quill } from \"react-quill\";\nimport \"react-quill/dist/quill.snow.css\";\n\n// MathQuill dependency\nimport \"./jquery\";\nimport \"mathquill/build/mathquill.js\";\nimport \"mathquill/build/mathquill.css\";\n\n// mathquill4quill include\nimport mathquill4quill from \"mathquill4quill\";\nimport \"mathquill4quill/mathquill4quill.css\";\n\n// demo page\nimport React from \"react\";\n\nexport default class Editor extends React.Component {\n  reactQuill = React.createRef();\n\n  componentDidMount() {\n    const enableMathQuillFormulaAuthoring = mathquill4quill({ Quill, katex });\n    enableMathQuillFormulaAuthoring(\n      this.reactQuill.current.editor,\n      this.props.options\n    );\n  }\n\n  render() {\n    return (\n      <ReactQuill\n        ref={this.reactQuill}\n        id=\"editor\"\n        modules={{\n          formula: true,\n          toolbar: [[\"video\", \"bold\", \"italic\", \"underline\", \"formula\"]]\n        }}\n        placeholder=\"Type text here, or click on the formula button to enter math.\"\n        theme=\"snow\"\n      />\n    );\n  }\n}\n","import React, { useState } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport Editor from \"./Editor\";\nimport \"./index.css\";\n\nconst CUSTOM_OPERATORS = [\n  [\"\\\\pm\", \"\\\\pm\"],\n  [\"\\\\sqrt{x}\", \"\\\\sqrt\"],\n  [\"\\\\sqrt[3]{x}\", \"\\\\sqrt[3]{}\"],\n  [\"\\\\sqrt[n]{x}\", \"\\\\nthroot\"],\n  [\"\\\\frac{x}{y}\", \"\\\\frac\"],\n  [\"\\\\sum^{s}_{x}{d}\", \"\\\\sum\"],\n  [\"\\\\prod^{s}_{x}{d}\", \"\\\\prod\"],\n  [\"\\\\coprod^{s}_{x}{d}\", \"\\\\coprod\"],\n  [\"\\\\int^{s}_{x}{d}\", \"\\\\int\"],\n  [\"\\\\binom{n}{k}\", \"\\\\binom\"]\n];\n\nfunction Index() {\n  const [operators, setOperators] = useState([]);\n  const [displayHistory, setDisplayHistory] = useState(false);\n\n  const toggleDisplayHistory = event => {\n    setDisplayHistory(event.target.checked);\n  };\n\n  const toggleOperators = event => {\n    setOperators(event.target.checked ? CUSTOM_OPERATORS : []);\n  };\n\n  const options = { displayHistory, operators };\n\n  return (\n    <main className=\"demo-container\">\n      <Editor options={options} key={JSON.stringify(options)} />\n\n      <label>\n        Use custom operator buttons:\n        <input type=\"checkbox\" className=\"option\" onChange={toggleOperators} />\n      </label>\n\n      <label>\n        Display formula history:\n        <input\n          type=\"checkbox\"\n          className=\"option\"\n          onChange={toggleDisplayHistory}\n        />\n      </label>\n\n      <footer>\n        <a href=\"https://github.com/c-w/mathquill4quill\">\n          <p>Fork me on Github</p>\n          <img\n            width=\"149\"\n            height=\"149\"\n            src=\"https://github.blog/wp-content/uploads/2008/12/forkme_right_darkblue_121621.png?resize=149%2C149\"\n            alt=\"Fork me on GitHub\"\n          />\n        </a>\n      </footer>\n    </main>\n  );\n}\n\nReactDOM.render(\n  <React.StrictMode>\n    <Index />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n","/* eslint-env browser, commonjs */\n\nwindow.mathquill4quill = function(dependencies) {\n  dependencies = dependencies || {};\n\n  const Quill = dependencies.Quill || window.Quill;\n  const MathQuill = dependencies.MathQuill || window.MathQuill;\n  const katex = dependencies.katex || window.katex;\n  const localStorage = dependencies.localStorage || window.localStorage;\n\n  function setCacheItem(key, value) {\n    try {\n      localStorage.setItem(key, value);\n    } catch (e) {\n      // eslint-disable-line no-empty\n    }\n  }\n\n  function getCacheItem(key) {\n    try {\n      return localStorage.getItem(key);\n    } catch (e) {\n      return \"\";\n    }\n  }\n\n  function removeCacheItem(key) {\n    try {\n      localStorage.removeItem(key);\n    } catch (e) {\n      // eslint-disable-line no-empty\n    }\n  }\n\n  function insertAfter(newNode, referenceNode) {\n    referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n  }\n\n  function isOperatorCommand(operator) {\n    return /^\\\\[A-Za-z]+$/.test(operator);\n  }\n\n  function enableMathQuillFormulaAuthoring(quill, options) {\n    options = options || {};\n\n    function areAllDependenciesMet() {\n      if (!Quill) {\n        console.log(\"Quill.js not loaded\"); // eslint-disable-line no-console\n        return false;\n      }\n\n      if (!MathQuill) {\n        console.log(\"MathQuill.js not loaded\"); // eslint-disable-line no-console\n        return false;\n      }\n\n      if (!katex) {\n        console.log(\"katex.js not loaded\"); // eslint-disable-line no-console\n        return false;\n      }\n\n      if (!quill.options.modules.formula) {\n        console.log(\"Formula module not enabled\"); // eslint-disable-line no-console\n        return false;\n      }\n\n      if (!MutationObserver) {\n        console.log(\"MutationObserver not defined\"); // eslint-disable-line no-console\n        return false;\n      }\n\n      return true;\n    }\n\n    function fetchHistoryList(key) {\n      try {\n        return JSON.parse(localStorage.getItem(key)) || [];\n      } catch (e) {\n        return [];\n      }\n    }\n\n    function addItemToHistoryList(key) {\n      const item = getCacheItem(key);\n      if (item && item.length > 0) {\n        const index = historyList.indexOf(item);\n        if (index != -1) {\n          historyList.splice(index, 1);\n        }\n        historyList.unshift(item);\n        if (historyList.length > historySize) historyList.pop();\n        try {\n          localStorage.setItem(historyCacheKey, JSON.stringify(historyList));\n        } catch (e) {\n          // eslint-disable-line no-empty\n        }\n      }\n    }\n\n    function getTooltip() {\n      return quill.container.getElementsByClassName(\"ql-tooltip\")[0];\n    }\n\n    function getSaveButton() {\n      const tooltip = getTooltip();\n      return tooltip.getElementsByClassName(\"ql-action\")[0];\n    }\n\n    function getLatexInput() {\n      const tooltip = getTooltip();\n      return tooltip.getElementsByTagName(\"input\")[0];\n    }\n\n    function newMathquillInput() {\n      const autofocus = options.autofocus == null ? true : options.autofocus;\n      const mathQuillConfig =\n        options.mathQuillConfig != null ? options.mathQuillConfig : {};\n      const cacheKey = options.cacheKey || \"__mathquill4quill_cache__\";\n      let mqInput = null;\n      let mqField = null;\n      let latexInputStyle = null;\n\n      function applyMathquillInputStyles(mqInput) {\n        mqInput.setAttribute(\"class\", \"mathquill4quill-mathquill-input\");\n      }\n\n      function applyLatexInputStyles(latexInput) {\n        latexInput.setAttribute(\"class\", \"mathquill4quill-latex-input\");\n      }\n\n      function syncMathquillToQuill(latexInput, saveButton) {\n        const handlers =\n          mathQuillConfig.handlers == null ? {} : mathQuillConfig.handlers;\n        mathQuillConfig.handlers = {\n          ...handlers,\n          edit() {\n            const latex = mqField.latex();\n            latexInput.value = latex;\n            setCacheItem(cacheKey, latex);\n          },\n          enter() {\n            saveButton.click();\n          }\n        };\n        const mqField = MathQuill.getInterface(2).MathField(\n          mqInput,\n          mathQuillConfig\n        );\n\n        const cachedLatex = getCacheItem(cacheKey);\n        if (cachedLatex) {\n          mqField.latex(cachedLatex);\n        }\n\n        saveButton.addEventListener(\"click\", () => {\n          addItemToHistoryList(cacheKey);\n          removeCacheItem(cacheKey);\n        });\n\n        return mqField;\n      }\n\n      function autofocusFormulaField(mqField) {\n        if (!autofocus) {\n          return;\n        }\n\n        window.setTimeout(() => mqField.focus(), 1);\n      }\n\n      return {\n        render() {\n          if (mqInput != null) {\n            return;\n          }\n\n          const latexInput = getLatexInput();\n          const saveButton = getSaveButton();\n\n          mqInput = document.createElement(\"span\");\n          applyMathquillInputStyles(mqInput);\n\n          latexInputStyle = latexInput.className;\n          applyLatexInputStyles(latexInput);\n\n          mqField = syncMathquillToQuill(latexInput, saveButton);\n          autofocusFormulaField(mqField);\n\n          insertAfter(mqInput, latexInput);\n          return mqField;\n        },\n        destroy() {\n          if (mqInput == null) {\n            return;\n          }\n\n          const latexInput = getLatexInput();\n\n          latexInput.setAttribute(\"class\", latexInputStyle);\n\n          mqInput.remove();\n          mqInput = null;\n        }\n      };\n    }\n\n    function newOperatorButtons() {\n      const operators = options.operators || [];\n      let container = null;\n\n      function applyOperatorButtonStyles(button) {\n        button.setAttribute(\"class\", \"mathquill4quill-operator-button\");\n      }\n\n      function applyOperatorContainerStyles(container) {\n        container.setAttribute(\"class\", \"mathquill4quill-operator-container\");\n      }\n\n      function createOperatorButton(element, mqField) {\n        const displayOperator = element[0];\n        const operator = element[1];\n\n        const button = document.createElement(\"button\");\n        button.setAttribute(\"type\", \"button\");\n        button.setAttribute(\"data-value\", operator);\n\n        katex.render(displayOperator, button, {\n          throwOnError: false\n        });\n        button.onclick = () => {\n          if (isOperatorCommand(operator)) {\n            mqField.cmd(operator);\n          } else {\n            mqField.write(operator);\n          }\n          mqField.focus();\n        };\n\n        return button;\n      }\n\n      return {\n        render(mqField) {\n          if (container != null || operators.length === 0) {\n            return;\n          }\n\n          const tooltip = getTooltip();\n\n          container = document.createElement(\"div\");\n          applyOperatorContainerStyles(container);\n\n          operators.forEach(element => {\n            const button = createOperatorButton(element, mqField);\n            applyOperatorButtonStyles(button);\n            container.appendChild(button);\n          });\n\n          tooltip.appendChild(container);\n        },\n        destroy() {\n          if (container == null) {\n            return;\n          }\n\n          container.remove();\n          container = null;\n        }\n      };\n    }\n\n    function newHistoryList() {\n      const history = historyList || [];\n      let historyDiv = null;\n\n      function applyHistoryButtonStyles(button) {\n        button.setAttribute(\"class\", \"mathquill4quill-history-button\");\n      }\n\n      function applyHistoryContainerStyles(container) {\n        container.setAttribute(\"class\", \"mathquill4quill-history-container\");\n      }\n\n      function createHistoryButton(latex, mqField) {\n        const button = document.createElement(\"button\");\n        button.setAttribute(\"type\", \"button\");\n\n        katex.render(latex, button, {\n          throwOnError: false\n        });\n        button.onclick = () => {\n          mqField.write(latex);\n          mqField.focus();\n        };\n\n        return button;\n      }\n\n      return {\n        render(mqField) {\n          fixToolTipHeight();\n\n          if (historyDiv != null || !displayHistory || history.length === 0) {\n            return;\n          }\n\n          const tooltip = getTooltip();\n\n          historyDiv = document.createElement(\"div\");\n          let container = document.createElement(\"div\");\n          applyHistoryContainerStyles(container);\n          let header = document.createElement(\"p\");\n          header.innerHTML = \"Past formulas (max \" + historySize + \")\";\n          historyDiv.appendChild(header);\n\n          history.forEach(element => {\n            const button = createHistoryButton(element, mqField);\n            applyHistoryButtonStyles(button);\n            container.appendChild(button);\n          });\n          historyDiv.appendChild(container);\n          tooltip.appendChild(historyDiv);\n        },\n        destroy() {\n          if (historyDiv == null) {\n            return;\n          }\n\n          historyDiv.remove();\n          historyDiv = null;\n        }\n      };\n    }\n\n    // If tooltip hangs below Quill div, Quill will position tooltip in bad place if function is clicked twice\n    // This addresses the position issue\n    function fixToolTipHeight() {\n      const tooltip = getTooltip();\n\n      if (\n        tooltip.getBoundingClientRect().top -\n          quill.container.getBoundingClientRect().top <\n        0\n      ) {\n        tooltip.style.top = \"0px\";\n      }\n    }\n\n    if (!areAllDependenciesMet()) {\n      return;\n    }\n\n    const tooltip = getTooltip();\n\n    const historyCacheKey =\n      options.historyCacheKey || \"__mathquill4quill_historylist_cache__\";\n    let historyList = fetchHistoryList(historyCacheKey);\n    const historySize = options.historySize || 10;\n    const displayHistory = options.displayHistory || false;\n\n    const mqInput = newMathquillInput();\n    const operatorButtons = newOperatorButtons();\n    const historyListButtons = newHistoryList();\n\n    const observer = new MutationObserver(() => {\n      const isFormulaTooltipActive =\n        !tooltip.classList.contains(\"ql-hidden\") &&\n        tooltip.attributes[\"data-mode\"] &&\n        tooltip.attributes[\"data-mode\"].value === \"formula\";\n\n      if (isFormulaTooltipActive) {\n        const mqField = mqInput.render();\n        operatorButtons.render(mqField);\n        historyListButtons.render(mqField);\n      } else {\n        mqInput.destroy();\n        operatorButtons.destroy();\n        historyListButtons.destroy();\n      }\n    });\n\n    observer.observe(tooltip, {\n      attributes: true,\n      attributeFilter: [\"class\", \"data-mode\"]\n    });\n  }\n\n  return enableMathQuillFormulaAuthoring;\n};\n\nif (typeof module !== \"undefined\" && module.exports) {\n  module.exports = window.mathquill4quill;\n}\n\n// for backwards compatibility with prototype-based API\nif (window.Quill) {\n  window.Quill.prototype.enableMathQuillFormulaAuthoring = function(options) {\n    window.mathquill4quill()(this, options);\n  };\n}\n"],"sourceRoot":""}